(window.webpackJsonp=window.webpackJsonp||[]).push([[215],{567:function(a,s,e){"use strict";e.r(s);var t=e(0),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"搭建zookeeper集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#搭建zookeeper集群"}},[a._v("#")]),a._v(" 搭建zookeeper集群")]),a._v(" "),s("h3",{attrs:{id:"主机规划"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#主机规划"}},[a._v("#")]),a._v(" 主机规划：")]),a._v(" "),s("p",[a._v("192.168.100.7　node1")]),a._v(" "),s("p",[a._v("192.168.100.8    node2")]),a._v(" "),s("p",[a._v("192.168.100.9    node3")]),a._v(" "),s("h3",{attrs:{id:"软件下载地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#软件下载地址"}},[a._v("#")]),a._v(" 软件下载地址：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /home/app\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wget")]),a._v(" http://mirrors.hust.edu.cn/apache/zookeeper/zookeeper-3.6.2/apache-zookeeper-3.6.2-bin.tar.gz\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"三台主机hosts文件一致"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三台主机hosts文件一致"}},[a._v("#")]),a._v(" 三台主机hosts文件一致：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cat /etc/hosts")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".100.7　node1\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".100.8  node2\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".100.9  node3\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h3",{attrs:{id:"在node1节点上"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在node1节点上"}},[a._v("#")]),a._v(" 在node1节点上")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# tar zookeeper-3.6.2.tar.gz -C /home/app/")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mv zookeeper-3.6.2 zookeeper")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cd zookeeper/conf/")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cp zoo_sample.cfg zoo.cfg")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("tickTime")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2000")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("initLimit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("syncLimit")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("dataDir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/tmp/zookeeper\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("clientPort")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2181")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("server.1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("node1:2888:3888\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("server.2")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("node2:2888:3888\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("server.3")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("node3:2888:3888\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("h3",{attrs:{id:"创建datadir目录创建-tmp-zookeeper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建datadir目录创建-tmp-zookeeper"}},[a._v("#")]),a._v(" 创建dataDir目录创建/tmp/zookeeper")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mkdir /tmp/zookeeper")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# touch /tmp/zookeeper/myid")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# echo 1 > /tmp/zookeeper/myid")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"将zookeeper文件复制到另外两个节点"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将zookeeper文件复制到另外两个节点"}},[a._v("#")]),a._v(" 将zookeeper文件复制到另外两个节点：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# scp -r zookeeper-3.6.2/ node2:/home/app/")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# scp -r zookeeper-3.6.2/ node3:/home/app/")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"node2创建datadir目录创建-tmp-zookeeper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node2创建datadir目录创建-tmp-zookeeper"}},[a._v("#")]),a._v(" node2创建dataDir目录创建/tmp/zookeeper")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[root@node2 conf]# mkdir /tmp/zookeeper\n[root@node2 conf]# touch /tmp/zookeeper/myid\n[root@node2 conf]# echo 2 > /tmp/zookeeper/myid\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"node3创建datadir目录创建-tmp-zookeeper"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#node3创建datadir目录创建-tmp-zookeeper"}},[a._v("#")]),a._v(" node3创建dataDir目录创建/tmp/zookeeper")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node3 conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mkdir /tmp/zookeeper")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node3 conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# touch /tmp/zookeeper/myid")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node3 conf"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# echo 3 > /tmp/zookeeper/myid")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"分别在每个节点上启动-zookeeper测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#分别在每个节点上启动-zookeeper测试"}},[a._v("#")]),a._v(" 分别在每个节点上启动 zookeeper测试：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 zookeeper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ./bin/zkServer.sh start")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node2 zookeeper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ./bin/zkServer.sh start")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node3 zookeeper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ./bin/zkServer.sh start")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"查看状态"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看状态"}},[a._v("#")]),a._v(" 查看状态")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 zookeeper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ./bin/zkServer.sh status")]),a._v("\nZooKeeper JMX enabled by default\nUsing config: /usr/local/zookeeper/bin/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/conf/zoo.cfg\nMode: follower\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node2 zookeeper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ./bin/zkServer.sh status")]),a._v("\nZooKeeper JMX enabled by default\nUsing config: /usr/local/zookeeper/bin/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/conf/zoo.cfg\nMode: leader\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node3 zookeeper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ./bin/zkServer.sh status")]),a._v("\nZooKeeper JMX enabled by default\nUsing config: /usr/local/zookeeper/bin/"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("/conf/zoo.cfg\nMode: follower\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("h2",{attrs:{id:"搭建kafka集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#搭建kafka集群"}},[a._v("#")]),a._v(" 搭建Kafka集群")]),a._v(" "),s("h3",{attrs:{id:"将kafka安装包上传到虚拟机-并解压"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将kafka安装包上传到虚拟机-并解压"}},[a._v("#")]),a._v(" 将Kafka安装包上传到虚拟机，并解压")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cd /home/app/")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# wget http://mirrors.hust.edu.cn/apache/kafka/2.8.0/kafka_2.13-2.8.0.tgz")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# tar -xvzf kafka_2.13-2.8.0.tgz")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cd /home/app/kafka_2.13-2.8.0/")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h3",{attrs:{id:"修改server-properties"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#修改server-properties"}},[a._v("#")]),a._v(" 修改server.properties")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cd config")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# vim server.properties")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#指定broker的id")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("broker.id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("listeners")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("PLAINTEXT://node1:9092\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("advertised.listeners")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("PLAINTEXT://node1:9092\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#指定kafka数据的位置")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("log.dirs")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/home/app/kafka_2.13-2.8.0/data\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("zookeeper.connect")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("node1:2181,node2:2181,node3:2181\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("h3",{attrs:{id:"将安装好的kafka的复制到另外两台服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#将安装好的kafka的复制到另外两台服务器"}},[a._v("#")]),a._v(" 将安装好的Kafka的复制到另外两台服务器")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cd /home/app")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# scp -r kafka_2.13-2.8.0/ node2:$PWD")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node1 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# scp -r kafka_2.13-2.8.0/ node3:$PWD")]),a._v("\n修改另外两个节点的broker.id分别为1和2\n-----node2-----\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node2 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cd /home/app/kafka_2.13-2.8.0/config")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node2 app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# vim server.properties")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#指定broker的id")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("broker.id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("listeners")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("PLAINTEXT://node2:9092\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("advertised.listeners")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("PLAINTEXT://node2:9092\n-----node3-----\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node3 ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cd /home/app/kafka_2.13-2.8.0/config")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root@node3 config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# vim server.properties")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#指定broker的id")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("broker.id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("listeners")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("PLAINTEXT://node3:9092\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("advertised.listeners")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("PLAINTEXT://node3:9092\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br")])]),s("h3",{attrs:{id:"配置kafka-home环境变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置kafka-home环境变量"}},[a._v("#")]),a._v(" 配置KAFKA_HOME环境变量")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" /etc/profile\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("KAFKA_HOME")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/export/server/kafka_2.13-2.8.0\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("export")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("PATH")])]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(":"),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PATH")]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${KAFKA_HOME}")]),a._v("\n分发到各个节点\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" /etc/profile node2.ip.cn:"),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PWD")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("scp")]),a._v(" /etc/profile node3.ip.cn:"),s("span",{pre:!0,attrs:{class:"token environment constant"}},[a._v("$PWD")]),a._v("\n每个节点加载环境变量\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /etc/profile\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("h3",{attrs:{id:"启动服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动服务器"}},[a._v("#")]),a._v(" 启动服务器")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#启动ZooKeeper")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("nohup")]),a._v(" bin/zookeeper-server-start.sh config/zookeeper.properties "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#启动kafka")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /export/server/kafka_2.12-2.4.1\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("nohup")]),a._v(" bin/kafka-server-start.sh config/server.properties "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#测试kafka集群是否启动成功")]),a._v("\nbin/kafka-topics.sh --bootstrap-server node1.ip.cn:9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--list")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("h3",{attrs:{id:"kafka一键启动-关闭"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka一键启动-关闭"}},[a._v("#")]),a._v(" Kafka一键启动/关闭")]),a._v(" "),s("h3",{attrs:{id:"在几点中创建-export-onekey-目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在几点中创建-export-onekey-目录"}},[a._v("#")]),a._v(" 在几点中创建/export/onekey 目录")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /home/app/onekey\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"准备slave配置文件-用于保存要启动哪几个节点上的kafka"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#准备slave配置文件-用于保存要启动哪几个节点上的kafka"}},[a._v("#")]),a._v(" 准备slave配置文件，用于保存要启动哪几个节点上的kafka")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("node1\nnode2\nnode3\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("h3",{attrs:{id:"编写start-kafka-sh脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编写start-kafka-sh脚本"}},[a._v("#")]),a._v(" 编写start-kafka.sh脚本")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" start-kafka.sh\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" ./slave "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("while")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("read")]),a._v(" line\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$line")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$line")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"source /etc/profile; export JMX_PORT=9988;\nnohup '),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${KAFKA_HOME}")]),a._v("/bin/kafka-server-start.sh "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("${KAFKA_HOME}")]),a._v('/config/server.properties > /dev/nul* 2>&1"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wait")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("done")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("h3",{attrs:{id:"编写stop-kafka-sh脚本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编写stop-kafka-sh脚本"}},[a._v("#")]),a._v(" 编写stop-kafka.sh脚本")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vim")]),a._v(" stop-kafka.sh\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cat")]),a._v(" ./salve "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("while")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("read")]),a._v(" line\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("do")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("echo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$line")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("ssh")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("$line")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("\"source /etc/profile; jps |grep Kafka |cut -d ' ' -f1 |xargs kill -9\"")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("&")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("wait")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("done")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("h2",{attrs:{id:"基础操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基础操作"}},[a._v("#")]),a._v(" 基础操作")]),a._v(" "),s("h3",{attrs:{id:"创建topic-主题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建topic-主题"}},[a._v("#")]),a._v(" 创建topic（主题）")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#创建名为test的主题")]),a._v("\nbin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--create")]),a._v(" --bootstrap-server node1.ip.cn:9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("test")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#查看目前kafka中的主题")]),a._v("\nbin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--list")]),a._v(" --bootstrap-server node1.ip.cn:9092\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h3",{attrs:{id:"生产消息到kafka"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生产消息到kafka"}},[a._v("#")]),a._v(" 生产消息到kafka")]),a._v(" "),s("p",[a._v("使用kafka内置的测试程序，生产一些消息到kafka的test主题中")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("bin/kafka-console-producer.sh --broker-list node1.ip.cn:9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("test")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"从kafka消费消息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从kafka消费消息"}},[a._v("#")]),a._v(" 从kafka消费消息")]),a._v(" "),s("p",[a._v("使用下面的命令来消费test主题中的消息")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("bin/kafka-console-consumer.sh --bootstrap-server node1.ip.cn:9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("test")]),a._v(" --from-beginning\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"使用kafka-tools操作kafka"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用kafka-tools操作kafka"}},[a._v("#")]),a._v(" 使用Kafka Tools操作Kafka")]),a._v(" "),s("h3",{attrs:{id:"连接kafka集群"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#连接kafka集群"}},[a._v("#")]),a._v(" 连接Kafka集群")]),a._v(" "),s("p",[a._v("安装kafka Tools后启动kafka")]),a._v(" "),s("h2",{attrs:{id:"kafka基准测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka基准测试"}},[a._v("#")]),a._v(" Kafka基准测试")]),a._v(" "),s("h3",{attrs:{id:"基于一个分区一个副本的基准测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#基于一个分区一个副本的基准测试"}},[a._v("#")]),a._v(" 基于一个分区一个副本的基准测试")]),a._v(" "),s("h4",{attrs:{id:"创建topic"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#创建topic"}},[a._v("#")]),a._v(" 创建topic")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("bin/kafka-topics.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--zookeeper")]),a._v(" node1:2181 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--create")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" benchmark "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--partitions")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" --replication-factor "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h4",{attrs:{id:"生成消息基本测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生成消息基本测试"}},[a._v("#")]),a._v(" 生成消息基本测试")]),a._v(" "),s("p",[a._v("在生产环境中，推荐使用生产5000W消息，这样性能数据会更准确些。为了方便测试，课程上演示500W的消息作为基准测试。")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("bin/kafka-producer-perf-test.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" benchmark --num-records "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5000000")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--throughput")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-1")]),a._v(" --record-size "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1000")]),a._v(" --producer-props "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("bootstrap.servers")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("node1:9092,node2:9092,node3:9092 "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("acks")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("blockquote",[s("p",[a._v("bin/kafka-producer-perf-test.sh")]),a._v(" "),s("p",[a._v("--topoc topic的名字")]),a._v(" "),s("p",[a._v("--num-records 总共指定生产数据量（默认5000W）")]),a._v(" "),s("p",[a._v("--throughput 指定吞吐量—限流（-1不指定）")]),a._v(" "),s("p",[a._v("--record-size record数据大小（字节）")]),a._v(" "),s("p",[a._v("--producer-props bootstrap.servers=node1:9092,node2:9092,node3:9092 acks=1 指定kafka集群地址，ACK模式；")])]),a._v(" "),s("p",[a._v("测试结果")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("吞吐量")]),a._v(" "),s("th",[a._v("93092.533979 records/sec"),s("br"),a._v("每秒9.3W条记录")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("吞吐速率")]),a._v(" "),s("td",[a._v("(88.78/sec)"),s("br"),a._v("每秒约89MB数据")])]),a._v(" "),s("tr",[s("td",[a._v("平均延迟时间")]),a._v(" "),s("td",[a._v("346.62 ms avg latency")])]),a._v(" "),s("tr",[s("td",[a._v("最大延迟时间")]),a._v(" "),s("td",[a._v("1003.00 ms max latency")])])])]),a._v(" "),s("h4",{attrs:{id:"消费消息基准测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消费消息基准测试"}},[a._v("#")]),a._v(" 消费消息基准测试")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("bin/kafka-consumer-perf-test.sh --broker-list node1:9092,node2:9092,node3:9092 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" benchmark --fetch-size "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1048576")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--messages")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5000000")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("blockquote",[s("p",[a._v("bin/kafka-consumer-perf-test.sh")]),a._v(" "),s("p",[a._v("--broker-list 指定kafka集群地址")]),a._v(" "),s("p",[a._v("--topic  指定topic的名称")]),a._v(" "),s("p",[a._v("--fetch--size 每次拉取的数据大小")]),a._v(" "),s("p",[a._v("--messages 总共要消费的消息个数")])]),a._v(" "),s("p",[a._v("测试结果")]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("data.consumed.in.MB"),s("br"),a._v("共计消费的数据")]),a._v(" "),s("th",[a._v("4768.3434MB")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("MB.sec"),s("br"),a._v("每秒消费的数量")]),a._v(" "),s("td",[a._v("445.6006"),s("br"),a._v("每秒445MB")])]),a._v(" "),s("tr",[s("td",[a._v("data.consumed.in.nMsg"),s("br"),a._v("共计消费的数量")]),a._v(" "),s("td",[a._v("5000000")])]),a._v(" "),s("tr",[s("td",[a._v("nMsg.sec"),s("br"),a._v("每秒的数量")]),a._v(" "),s("td",[a._v("467234.0518"),s("br"),a._v("每秒46.7W")])])])]),a._v(" "),s("h2",{attrs:{id:"kafka中得重要概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka中得重要概念"}},[a._v("#")]),a._v(" Kafka中得重要概念")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("broker")]),a._v(" "),s("ul",[s("li",[a._v("kafka服务器，生产者、消费者都要连接broker")]),a._v(" "),s("li",[a._v("一个集群由多个broker组成，功能实现kafka集群得负载均衡、容错")])])]),a._v(" "),s("li",[s("p",[a._v("producer：生产者")])]),a._v(" "),s("li",[s("p",[a._v("consumer：消费者")])]),a._v(" "),s("li",[s("p",[a._v("topic：主题，一个Kafka集群中，可以包含多个topic。一个topic可以包含多个分区")]),a._v(" "),s("ul",[s("li",[a._v("是一个逻辑结构，生产、消费消息都需要指定topic")])])]),a._v(" "),s("li",[s("p",[a._v("partiton：kafka集群得分布式就是由分区来实现的。一个topic中得消息可以分布在topic中得不同partition中")])]),a._v(" "),s("li",[s("p",[a._v("replica：副本，实现kafka集群的容错，实现partition的容错。一个topic至少应该包含大于一个的副本")])]),a._v(" "),s("li",[s("p",[a._v("consumer group：消费者组，一个消费者组中的消费者可以共同消费topic中的分区数据。每一个消费者组都是一个唯一的名字。配置group.id一样的消费者是属于同一个组中")])]),a._v(" "),s("li",[s("p",[a._v("offset：偏移量。相对消费者、partition来说。可以通过offset来拉取数据")])])]),a._v(" "),s("h3",{attrs:{id:"消费者组"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消费者组"}},[a._v("#")]),a._v(" 消费者组")]),a._v(" "),s("p",[a._v("一个消费者组中可以包含多个消费者，共同来消费topic中的数据")]),a._v(" "),s("p",[a._v("一个topic中如果只有一个分区，那么这个分区智能被某个组中的一个消费者消费")]),a._v(" "),s("p",[a._v("有多少分区，那么就可以被同一个组内的多少个消费者消费")]),a._v(" "),s("p",[a._v("设置test topic为2个分区")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("bin/kafka-topic.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--zookeeper")]),a._v(" node1:2181 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-alter")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--partitons")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--topic")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("test")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"幂等性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#幂等性"}},[a._v("#")]),a._v(" 幂等性")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("生产者消息重复的问题")]),a._v(" "),s("ul",[s("li",[a._v("Kafka生产消息到partition，如果直接发送消息，Kafka会将消息保存到分区中，但Kafka会返回一个ack给生产者，标识当前操作是否成功，是否已经保存了这条消息。如果ack响应的过程失败了，此时生产者会重试，继续发送没有发送成功的消息，Kafka又会保存一条一摸一样的消息")])])]),a._v(" "),s("li",[s("p",[a._v("在Kafka中可以开启幂等性")]),a._v(" "),s("ul",[s("li",[a._v("当kafka的生产消息时，会增加一个pid（生产者的唯一编号）和sequence number（针对消息的一个递增序列）")]),a._v(" "),s("li",[a._v("发送消息，会连着pid和sequence number一起放松")]),a._v(" "),s("li",[a._v("Kafka接收到消息，会将消息和pid、sequence number一并保存下来")]),a._v(" "),s("li",[a._v("如果ack响应失败，生产者重试，再次发送消息时，Kafka会根据pid、sequence number是否需要再保存一条消息")]),a._v(" "),s("li",[a._v("判断条件：生产者发送过来的sequence number是否小于等于parition中消息对应的sequence")])])])]),a._v(" "),s("h3",{attrs:{id:"kafka中的副本机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka中的副本机制"}},[a._v("#")]),a._v(" kafka中的副本机制")]),a._v(" "),s("h4",{attrs:{id:"生产者的分区写入策略"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#生产者的分区写入策略"}},[a._v("#")]),a._v(" 生产者的分区写入策略")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("轮询(按照消息尽量保证每一个分区的负载)策略，消息会均地分布到每个partition")]),a._v(" "),s("p",[a._v("写入消息地时候，key为null的时候，默认使用的是轮询策略")])]),a._v(" "),s("li",[s("p",[a._v("随机策略（不使用）")])]),a._v(" "),s("li",[s("p",[a._v("按key写入策略，key.hash()%")])]),a._v(" "),s("li",[s("p",[a._v("自定义分区策略")])])]),a._v(" "),s("blockquote",[s("p",[a._v("乱序问题")]),a._v(" "),s("ul",[s("li",[a._v("在Kafka中生产者是有写入策略，如果topic有多个分区，就会将数据分分散在不同的partition中存储")]),a._v(" "),s("li",[a._v("当partition数量大于1的时候，数据（消息）会打散分布在不同的partion中")]),a._v(" "),s("li",[a._v("如果只有一个分区，消息是有序的")])])]),a._v(" "),s("h4",{attrs:{id:"消费组consumer-group-rebaleance机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消费组consumer-group-rebaleance机制"}},[a._v("#")]),a._v(" 消费组Consumer Group Rebaleance机制")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("再均衡：在某些情况下，消费者组中的消费的分区会产生变化，会导致消费者分配不均匀（例如：有两个消费者消费3个，因为某个partition崩溃了，还有一个消费者当前没有分区要削峰），当Kafka Consumer Group就会启动rebalance机制，重新平衡这个 Consumer Group 内的消费者消费的分区分配。")])]),a._v(" "),s("li",[s("p",[a._v("触发时机")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("消费者数量发生变化")]),a._v(" "),s("ul",[s("li",[a._v("某个消费者crash")]),a._v(" "),s("li",[a._v("新增消费者")])])]),a._v(" "),s("li",[s("p",[a._v("topic的数量发生变化")]),a._v(" "),s("ul",[s("li",[a._v("某个topic被删除")])])]),a._v(" "),s("li",[s("p",[a._v("partition的数量发生变化")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("删除partition")])]),a._v(" "),s("li",[s("p",[a._v("新增partition")])])])])])]),a._v(" "),s("li",[s("p",[a._v("不良影响")]),a._v(" "),s("ul",[s("li",[a._v("发生rebalance，所有的consumer将不再工作，共同来参与再均衡，直到每个消费者都已经被成功分配所需要消费的分区为止（rebalance结束）")])])])]),a._v(" "),s("h4",{attrs:{id:"消费者的分配策略"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消费者的分配策略"}},[a._v("#")]),a._v(" 消费者的分配策略")]),a._v(" "),s("p",[a._v("分区分配策略：保障每个消费者尽量能够均衡地消费分区数据据，不能出现某个消费者分区的数量特别多，某个消费者消费的分区特别少")]),a._v(" "),s("ul",[s("li",[a._v("Rangele分配策略（范围分配策略）\n"),s("ul",[s("li",[a._v("n：分区的数量/消费者数量")]),a._v(" "),s("li",[a._v("m：分区的数量%消费者数量")])])]),a._v(" "),s("li",[a._v("前m个消费者消费n+1个分区")]),a._v(" "),s("li",[a._v("剩余的消费者消费nge")]),a._v(" "),s("li",[a._v("RoundRobin分配策略（轮询分配策略）")]),a._v(" "),s("li",[a._v("消费者挨个分配消费的分区")]),a._v(" "),s("li",[a._v("Striky粘性分配策略\n"),s("ul",[s("li",[a._v("在没有发生rebalance跟轮询分配策略是一致的")]),a._v(" "),s("li",[a._v("发生了rebalance，轮询分配测率。重新走一遍轮询分配的过程。而粘性会保证跟上一次的尽量一致，只是将新的需要分配的分区，均匀的分配到现有可用的消费者中即可")]),a._v(" "),s("li",[a._v("减少上下文的切换")])])])]),a._v(" "),s("h3",{attrs:{id:"副本的ack机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#副本的ack机制"}},[a._v("#")]),a._v(" 副本的ACK机制")]),a._v(" "),s("p",[a._v("producer是不断地往Kafka中写入数据，写入数据会有一个返回结果，表示是否写入成功。这里对应有一个ACKs的配置。")]),a._v(" "),s("ul",[s("li",[a._v("acks = 0：生产者只管写入、不管是否写入成功，可能会数据丢失。性能是最好的")]),a._v(" "),s("li",[a._v("acks=1：生产者会等到leader分区写入成功后，返回成功，接着发送吓一跳")]),a._v(" "),s("li",[a._v("acks=-1/all：确保消息写入到leader分区、还确保消息写入到对应副本都成功后，接着发送下一条性能是最差的")])]),a._v(" "),s("p",[a._v("根据业务情况来选择ack机制，是要求性能最高，一部分数据丢失影响不大，可以选择0/1。如果要求数据一定不能丢失，就得配置为-1/all。")]),a._v(" "),s("p",[a._v("分区中是有leader和follower的概念，为了确保消费者消费的数据是一致的，只能从分区leafer去读写消息follower做的事情就是同步数据，Backup")]),a._v(" "),s("h3",{attrs:{id:"高级api-high-level-api-、低级api-low-level-api"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#高级api-high-level-api-、低级api-low-level-api"}},[a._v("#")]),a._v(" 高级API（High-Level API）、低级API（Low-level API）")]),a._v(" "),s("ul",[s("li",[a._v("高级APi就是直接让Kafka帮助管理、处理分配、数据\n"),s("ul",[s("li",[a._v("offset存储在ZK中")]),a._v(" "),s("li",[a._v("由Kafka的rebalance来控制消费者分配的分区")]),a._v(" "),s("li",[a._v("开发起来比较简单，无需开发者关注底层细节")]),a._v(" "),s("li",[a._v("无法做到细粒度的控制")])])]),a._v(" "),s("li",[a._v("低级API：由编写的程序来控制逻辑\n"),s("ul",[s("li",[a._v("自己来管理offset，可以将offset存储在ZK、MySQL、Redis、HBase、Flink的转台存储")]),a._v(" "),s("li",[a._v("指定消费者拉取某个分区的数据")]),a._v(" "),s("li",[a._v("可以做到细粒度的控制")]),a._v(" "),s("li",[a._v("原有的Kafka的策略会失效，需要我们自己来实现消费机制")])])])]),a._v(" "),s("h2",{attrs:{id:"kafka原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka原理"}},[a._v("#")]),a._v(" Kafka原理")]),a._v(" "),s("h3",{attrs:{id:"leader和follower"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#leader和follower"}},[a._v("#")]),a._v(" leader和follower")]),a._v(" "),s("ul",[s("li",[a._v("Kafka中的leader和follower 是相对分区有意义，不是相对broker")]),a._v(" "),s("li",[a._v("Kafka在创建topic的时候，会尽量分配分区的leader在不同的broker中，其实就是负载均衡")]),a._v(" "),s("li",[a._v("leader职责：读写数据")]),a._v(" "),s("li",[a._v("follower职责：同步数据、参与选举（leader crash 之后，会选举一个follower重新称为分区的leader）")]),a._v(" "),s("li",[a._v("注意和ZooKeeper区分")]),a._v(" "),s("li",[a._v("ZK的leader负责读、写、follower可以读取\n"),s("ul",[s("li",[a._v("ZK的leader负责读、写、followe可以读取")]),a._v(" "),s("li",[a._v("Kafka的leader负责读写、follower不能读取数据（确保每个消费者消费的数据是一致的），Kafka一个topic有多个分区leader，一样可以实现数据操作的负载均衡")])])])]),a._v(" "),s("h3",{attrs:{id:"ar-isr-or"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ar-isr-or"}},[a._v("#")]),a._v(" AR\\ISR\\OR")]),a._v(" "),s("ul",[s("li",[a._v("AR表示一个topic下的所有副本")]),a._v(" "),s("li",[a._v("ISR：In Sync Replicas，正在同步的副本（可以理解为当前几个follower是存活的）")]),a._v(" "),s("li",[a._v("OSR：Out of Sync Replicas，不在同步的副本")]),a._v(" "),s("li",[a._v("AR = ISR+OSR")])]),a._v(" "),s("h3",{attrs:{id:"leader选举"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#leader选举"}},[a._v("#")]),a._v(" leader选举")]),a._v(" "),s("p",[a._v("Controller：controller是Kafka集群的老大，是针对Broker的一个角色")]),a._v(" "),s("ul",[s("li",[a._v("controller是高可用的，是通过ZK来进行选举")])]),a._v(" "),s("p",[a._v("Leader：是针对partition的一个角色")]),a._v(" "),s("ul",[s("li",[a._v("leader是通过ISR来进行快速选举")])]),a._v(" "),s("p",[a._v("如果Kafka是基于ZK来进行选举，ZK的压力可能会比较大。例如：某个节点崩溃，这个节点上不仅仅有一个leader，是由不少的leader需要选举。通过ISR快速进行选举")]),a._v(" "),s("p",[a._v("leader的负载均衡")]),a._v(" "),s("ul",[s("li",[a._v("如果某个broker crash之后，就可能回导致partition的leader分布不均匀，就是一个broker上存在一个topic下不通partition的leader")]),a._v(" "),s("li",[a._v("通过以下指令，可以将leader分配到优先的leader对用的broker，确保leader是均匀分配的")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("bin/kafka-leader-election.sh --bootstrap-server node1:9092 --topic test --partition=2 --election-type preferred\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"kafka读写流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka读写流程"}},[a._v("#")]),a._v(" Kafka读写流程")]),a._v(" "),s("p",[a._v("写流程")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("通过ZooKeeper找partition对应的leader，leader是负责读写")]),a._v(" "),s("ul",[s("li",[a._v("producer开始写入数据")]),a._v(" "),s("li",[a._v("ISR里面的follower开始同步数据，并返回给leader ACK")]),a._v(" "),s("li",[a._v("返回给producer ACK")])])]),a._v(" "),s("li",[s("p",[a._v("读流程")]),a._v(" "),s("ul",[s("li",[a._v("通过Zookeeper找partition对应的leader，leader是负责读的")]),a._v(" "),s("li",[a._v("通过Zookeeper找到消费者对应的offset")]),a._v(" "),s("li",[a._v("然后开始从offset往后顺序拉取数据")]),a._v(" "),s("li",[a._v("提交offset（自动提交-每隔多少秒提交一次offset、手动提交--放入到事务中提交）")])])])]),a._v(" "),s("h3",{attrs:{id:"kafka的物理存储"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka的物理存储"}},[a._v("#")]),a._v(" Kafka的物理存储")]),a._v(" "),s("ul",[s("li",[a._v("Kafka的数据组织结构\n"),s("ul",[s("li",[a._v("topic")]),a._v(" "),s("li",[a._v("partition")]),a._v(" "),s("li",[a._v("segment\n"),s("ul",[s("li",[a._v(".log数据文件")]),a._v(" "),s("li",[a._v(".index（稀疏索引）")]),a._v(" "),s("li",[a._v(".timeindex（根据时间做的索引）")])])])])]),a._v(" "),s("li",[a._v("深入了解数据的流程\n"),s("ul",[s("li",[a._v("消费者的offset是一个针对partition全局offset")]),a._v(" "),s("li",[a._v("可以根据这个offset找到segment段")]),a._v(" "),s("li",[a._v("接着需要将全局的offset转换成segment的局部offset")]),a._v(" "),s("li",[a._v("根据局部的offset，就可以从（.index稀疏索引）找到对应的数据位置")]),a._v(" "),s("li",[a._v("开始顺序读取")])])])]),a._v(" "),s("h3",{attrs:{id:"消息传递语义性"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#消息传递语义性"}},[a._v("#")]),a._v(" 消息传递语义性")]),a._v(" "),s("p",[a._v("Flink里面又对应的每种不同机制的保证，提供Exactly-once保障（二阶段事务提交方式）")]),a._v(" "),s("ul",[s("li",[a._v("At-most once：最多一次（只管把数据消费到，不管有没有成功，可能有数据丢失）")]),a._v(" "),s("li",[a._v("At-least once：最少一次（有可能会出现重复消费）")]),a._v(" "),s("li",[a._v("Exactly once：仅又一次（事务性的保障，保证消息有且呗处理一次）")])]),a._v(" "),s("h3",{attrs:{id:"kafka消息不丢失"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka消息不丢失"}},[a._v("#")]),a._v(" Kafka消息不丢失")]),a._v(" "),s("ul",[s("li",[s("p",[a._v("broker消息不丢失：又副本relicas的存在，会不断的从leader中同步副本，所以，一个broker crash，不会导致数据丢失，除非只有一个副本。")])]),a._v(" "),s("li",[s("p",[a._v("生产者消息不丢失：ACK机制（配置成ALL/-1）、配置成0，或者1可能存在丢失")])]),a._v(" "),s("li",[s("p",[a._v("消费者消费不丢失，重点控制offset")]),a._v(" "),s("p",[a._v("At-least once：一种数据可能会重复消费")]),a._v(" "),s("p",[a._v("Exactly once：仅被一次消费")])])]),a._v(" "),s("h3",{attrs:{id:"数据积压"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据积压"}},[a._v("#")]),a._v(" 数据积压")]),a._v(" "),s("ul",[s("li",[a._v("数据挤压是指消费者因为一些外部IO、一些比较耗时的操作（Full GC —— Stop the world），就会造成消息在partition中一直存在得不到消费，就会产生数据积压")]),a._v(" "),s("li",[a._v("在企业中，我们要有监控系统，如果出现这种情况，需要尽快处理。虽然后续的Spark Streaming/Flink可以实现背压机制，但是数据库积累太多一定对实时系统的实时性是有影响的")])]),a._v(" "),s("h2",{attrs:{id:"kafka-eagle-安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#kafka-eagle-安装"}},[a._v("#")]),a._v(" Kafka Eagle 安装")])])}),[],!1,null,null,null);s.default=r.exports}}]);
<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>容器Kubernetes | KNOTE</title>
    <meta name="generator" content="VuePress 1.9.9">
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <script src="https://cdn.staticfile.org/twikoo/1.6.7/twikoo.all.min.js"></script>
    <script>var _hmt = _hmt || [];
          (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?267c5680c2ffb468ca29c45ffe6801da"; 
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
          })();
          </script>
    <meta name="description" content="学习Java, Web, 框架, 微服务, 工具, 前端等相关知识, 记录生活和技术路程, 同时分享编程技巧。">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="keywords" content="学习Java、Web、框架、微服务、工具、前端等相关知识, 记录生活和技术路程。">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.ef7cd65c.css" as="style"><link rel="preload" href="/assets/js/app.be13efeb.js" as="script"><link rel="preload" href="/assets/js/2.6721fee8.js" as="script"><link rel="preload" href="/assets/js/503.5a73da6a.js" as="script"><link rel="preload" href="/assets/js/4.7df05356.js" as="script"><link rel="prefetch" href="/assets/js/10.9fc0ad5e.js"><link rel="prefetch" href="/assets/js/100.445a953f.js"><link rel="prefetch" href="/assets/js/101.50f3f636.js"><link rel="prefetch" href="/assets/js/102.ea01a0a9.js"><link rel="prefetch" href="/assets/js/103.48c80b71.js"><link rel="prefetch" href="/assets/js/104.c1304567.js"><link rel="prefetch" href="/assets/js/105.21f8b504.js"><link rel="prefetch" href="/assets/js/106.bc15f6b1.js"><link rel="prefetch" href="/assets/js/107.369451a9.js"><link rel="prefetch" href="/assets/js/108.ad4f8dbb.js"><link rel="prefetch" href="/assets/js/109.4c0ac598.js"><link rel="prefetch" href="/assets/js/11.571f9844.js"><link rel="prefetch" href="/assets/js/110.1e132789.js"><link rel="prefetch" href="/assets/js/111.3e69498d.js"><link rel="prefetch" href="/assets/js/112.cb20729c.js"><link rel="prefetch" href="/assets/js/113.2f080aa8.js"><link rel="prefetch" href="/assets/js/114.99d37d0a.js"><link rel="prefetch" href="/assets/js/115.aa87050b.js"><link rel="prefetch" href="/assets/js/116.b5fa1b2e.js"><link rel="prefetch" href="/assets/js/117.01d3ca92.js"><link rel="prefetch" href="/assets/js/118.efbecdc5.js"><link rel="prefetch" href="/assets/js/119.8ad5c904.js"><link rel="prefetch" href="/assets/js/12.a3002f91.js"><link rel="prefetch" href="/assets/js/120.f9d2779e.js"><link rel="prefetch" href="/assets/js/121.77249b18.js"><link rel="prefetch" href="/assets/js/122.c9167ca2.js"><link rel="prefetch" href="/assets/js/123.70789fe4.js"><link rel="prefetch" href="/assets/js/124.e1f1ba48.js"><link rel="prefetch" href="/assets/js/125.05e8e963.js"><link rel="prefetch" href="/assets/js/126.87fa90c1.js"><link rel="prefetch" href="/assets/js/127.d36d7dfd.js"><link rel="prefetch" href="/assets/js/128.729d369a.js"><link rel="prefetch" href="/assets/js/129.bdd0e080.js"><link rel="prefetch" href="/assets/js/13.d769b73a.js"><link rel="prefetch" href="/assets/js/130.17b3a98a.js"><link rel="prefetch" href="/assets/js/131.6462d2dd.js"><link rel="prefetch" href="/assets/js/132.9f77f2b3.js"><link rel="prefetch" href="/assets/js/133.b11dacc2.js"><link rel="prefetch" href="/assets/js/134.f94bc9ab.js"><link rel="prefetch" href="/assets/js/135.592b15b0.js"><link rel="prefetch" href="/assets/js/136.358ac083.js"><link rel="prefetch" href="/assets/js/137.8e5be7ac.js"><link rel="prefetch" href="/assets/js/138.a1358061.js"><link rel="prefetch" href="/assets/js/139.5f959387.js"><link rel="prefetch" href="/assets/js/14.96b83c4a.js"><link rel="prefetch" href="/assets/js/140.e034ec3e.js"><link rel="prefetch" href="/assets/js/141.cf28f196.js"><link rel="prefetch" href="/assets/js/142.005c6885.js"><link rel="prefetch" href="/assets/js/143.92dbb563.js"><link rel="prefetch" href="/assets/js/144.263bc914.js"><link rel="prefetch" href="/assets/js/145.ba7404c7.js"><link rel="prefetch" href="/assets/js/146.8c5c427e.js"><link rel="prefetch" href="/assets/js/147.15f5203d.js"><link rel="prefetch" href="/assets/js/148.b2294b7e.js"><link rel="prefetch" href="/assets/js/149.29566afd.js"><link rel="prefetch" href="/assets/js/15.456873d3.js"><link rel="prefetch" href="/assets/js/150.e513c541.js"><link rel="prefetch" href="/assets/js/151.feac0309.js"><link rel="prefetch" href="/assets/js/152.6b80af4d.js"><link rel="prefetch" href="/assets/js/153.663db95c.js"><link rel="prefetch" href="/assets/js/154.027f8e44.js"><link rel="prefetch" href="/assets/js/155.472d5cc5.js"><link rel="prefetch" href="/assets/js/156.adbc4f7d.js"><link rel="prefetch" href="/assets/js/157.9c2e3c48.js"><link rel="prefetch" href="/assets/js/158.1b927721.js"><link rel="prefetch" href="/assets/js/159.6887401e.js"><link rel="prefetch" href="/assets/js/16.13dd0421.js"><link rel="prefetch" href="/assets/js/160.dc3fcdbe.js"><link rel="prefetch" href="/assets/js/161.92df3db6.js"><link rel="prefetch" href="/assets/js/162.3d998157.js"><link rel="prefetch" href="/assets/js/163.ccf415fb.js"><link rel="prefetch" href="/assets/js/164.5c460632.js"><link rel="prefetch" href="/assets/js/165.4644071d.js"><link rel="prefetch" href="/assets/js/166.c0f8bab5.js"><link rel="prefetch" href="/assets/js/167.fa6727bf.js"><link rel="prefetch" href="/assets/js/168.a69e9264.js"><link rel="prefetch" href="/assets/js/169.3f276231.js"><link rel="prefetch" href="/assets/js/17.0d0d70be.js"><link rel="prefetch" href="/assets/js/170.07ad4c0d.js"><link rel="prefetch" href="/assets/js/171.bba2325a.js"><link rel="prefetch" href="/assets/js/172.18bb4010.js"><link rel="prefetch" href="/assets/js/173.08665888.js"><link rel="prefetch" href="/assets/js/174.e226515b.js"><link rel="prefetch" href="/assets/js/175.d9e7eff1.js"><link rel="prefetch" href="/assets/js/176.aae678ec.js"><link rel="prefetch" href="/assets/js/177.66366b65.js"><link rel="prefetch" href="/assets/js/178.f1dc8fcf.js"><link rel="prefetch" href="/assets/js/179.58bbef7b.js"><link rel="prefetch" href="/assets/js/18.3d7ad613.js"><link rel="prefetch" href="/assets/js/180.5670e6d4.js"><link rel="prefetch" href="/assets/js/181.c4b18cfb.js"><link rel="prefetch" href="/assets/js/182.fe847048.js"><link rel="prefetch" href="/assets/js/183.531b6c4e.js"><link rel="prefetch" href="/assets/js/184.8cd79eb1.js"><link rel="prefetch" href="/assets/js/185.d0c46c5e.js"><link rel="prefetch" href="/assets/js/186.0defd941.js"><link rel="prefetch" href="/assets/js/187.5487a6fd.js"><link rel="prefetch" href="/assets/js/188.553b85b1.js"><link rel="prefetch" href="/assets/js/189.8c79812e.js"><link rel="prefetch" href="/assets/js/19.a903a732.js"><link rel="prefetch" href="/assets/js/190.d2064022.js"><link rel="prefetch" href="/assets/js/191.aa182c57.js"><link rel="prefetch" href="/assets/js/192.46a492bb.js"><link rel="prefetch" href="/assets/js/193.b032a923.js"><link rel="prefetch" href="/assets/js/194.501d2ff8.js"><link rel="prefetch" href="/assets/js/195.d050ca2f.js"><link rel="prefetch" href="/assets/js/196.8d74c0e4.js"><link rel="prefetch" href="/assets/js/197.902e46b4.js"><link rel="prefetch" href="/assets/js/198.296ffc6b.js"><link rel="prefetch" href="/assets/js/199.7d6ec003.js"><link rel="prefetch" href="/assets/js/20.ace6ca43.js"><link rel="prefetch" href="/assets/js/200.09c3569d.js"><link rel="prefetch" href="/assets/js/201.b5fd8aea.js"><link rel="prefetch" href="/assets/js/202.d4148767.js"><link rel="prefetch" href="/assets/js/203.24256bee.js"><link rel="prefetch" href="/assets/js/204.8668a823.js"><link rel="prefetch" href="/assets/js/205.86b35550.js"><link rel="prefetch" href="/assets/js/206.108543fc.js"><link rel="prefetch" href="/assets/js/207.401807da.js"><link rel="prefetch" href="/assets/js/208.d0d16f62.js"><link rel="prefetch" href="/assets/js/209.5f85f70d.js"><link rel="prefetch" href="/assets/js/21.3180c41b.js"><link rel="prefetch" href="/assets/js/210.c7e1a0f7.js"><link rel="prefetch" href="/assets/js/211.d0d0049e.js"><link rel="prefetch" href="/assets/js/212.4449a934.js"><link rel="prefetch" href="/assets/js/213.26ed2de8.js"><link rel="prefetch" href="/assets/js/214.d5d951fb.js"><link rel="prefetch" href="/assets/js/215.52f822c3.js"><link rel="prefetch" href="/assets/js/216.fef91b5c.js"><link rel="prefetch" href="/assets/js/217.9703ec89.js"><link rel="prefetch" href="/assets/js/218.1fc1108b.js"><link rel="prefetch" href="/assets/js/219.716760e5.js"><link rel="prefetch" href="/assets/js/22.dc4e825a.js"><link rel="prefetch" href="/assets/js/220.feca2555.js"><link rel="prefetch" href="/assets/js/221.20434b00.js"><link rel="prefetch" href="/assets/js/222.1583c395.js"><link rel="prefetch" href="/assets/js/223.9dee736e.js"><link rel="prefetch" href="/assets/js/224.b38a4279.js"><link rel="prefetch" href="/assets/js/225.95e1ee3a.js"><link rel="prefetch" href="/assets/js/226.23994a6a.js"><link rel="prefetch" href="/assets/js/227.b1a0221b.js"><link rel="prefetch" href="/assets/js/228.9d8f821b.js"><link rel="prefetch" href="/assets/js/229.4cdf2c59.js"><link rel="prefetch" href="/assets/js/23.77cffbcd.js"><link rel="prefetch" href="/assets/js/230.9b82e4da.js"><link rel="prefetch" href="/assets/js/231.453b67d6.js"><link rel="prefetch" href="/assets/js/232.cbf18b51.js"><link rel="prefetch" href="/assets/js/233.bba5884d.js"><link rel="prefetch" href="/assets/js/234.bb37aa51.js"><link rel="prefetch" href="/assets/js/235.380fc23e.js"><link rel="prefetch" href="/assets/js/236.48827a8e.js"><link rel="prefetch" href="/assets/js/237.6076f1eb.js"><link rel="prefetch" href="/assets/js/238.44bdac10.js"><link rel="prefetch" href="/assets/js/239.09968718.js"><link rel="prefetch" href="/assets/js/24.0875dace.js"><link rel="prefetch" href="/assets/js/240.24cc7265.js"><link rel="prefetch" href="/assets/js/241.764f0120.js"><link rel="prefetch" href="/assets/js/242.98e839c4.js"><link rel="prefetch" href="/assets/js/243.dfaf5b0f.js"><link rel="prefetch" href="/assets/js/244.6dbe170b.js"><link rel="prefetch" href="/assets/js/245.f0cf26b8.js"><link rel="prefetch" href="/assets/js/246.89dbfa00.js"><link rel="prefetch" href="/assets/js/247.f245ff82.js"><link rel="prefetch" href="/assets/js/248.e321588d.js"><link rel="prefetch" href="/assets/js/249.78519da7.js"><link rel="prefetch" href="/assets/js/25.b8c0e9b3.js"><link rel="prefetch" href="/assets/js/250.8c9f6c12.js"><link rel="prefetch" href="/assets/js/251.854095e0.js"><link rel="prefetch" href="/assets/js/252.11904a27.js"><link rel="prefetch" href="/assets/js/253.a2ef15c0.js"><link rel="prefetch" href="/assets/js/254.24aa1a5f.js"><link rel="prefetch" href="/assets/js/255.ad478f7c.js"><link rel="prefetch" href="/assets/js/256.f578e658.js"><link rel="prefetch" href="/assets/js/257.3372f368.js"><link rel="prefetch" href="/assets/js/258.5a31555d.js"><link rel="prefetch" href="/assets/js/259.ac3240e3.js"><link rel="prefetch" href="/assets/js/26.09fa8bef.js"><link rel="prefetch" href="/assets/js/260.a4a13e65.js"><link rel="prefetch" href="/assets/js/261.7bc38b45.js"><link rel="prefetch" href="/assets/js/262.a0b99b19.js"><link rel="prefetch" href="/assets/js/263.b0ff4be3.js"><link rel="prefetch" href="/assets/js/264.0fb5638f.js"><link rel="prefetch" href="/assets/js/265.3ee362b2.js"><link rel="prefetch" href="/assets/js/266.64fa79ac.js"><link rel="prefetch" href="/assets/js/267.85dfb5a6.js"><link rel="prefetch" href="/assets/js/268.18d5a909.js"><link rel="prefetch" href="/assets/js/269.737840b8.js"><link rel="prefetch" href="/assets/js/27.16c9b9e6.js"><link rel="prefetch" href="/assets/js/270.80efb202.js"><link rel="prefetch" href="/assets/js/271.cce81f5c.js"><link rel="prefetch" href="/assets/js/272.a17b419d.js"><link rel="prefetch" href="/assets/js/273.4869cb0e.js"><link rel="prefetch" href="/assets/js/274.d7fd3e4f.js"><link rel="prefetch" href="/assets/js/275.f9742da4.js"><link rel="prefetch" href="/assets/js/276.8bc5b1a8.js"><link rel="prefetch" href="/assets/js/277.a6ce8db8.js"><link rel="prefetch" href="/assets/js/278.8a1bae97.js"><link rel="prefetch" href="/assets/js/279.a04e0f08.js"><link rel="prefetch" href="/assets/js/28.24adc85f.js"><link rel="prefetch" href="/assets/js/280.f79053e2.js"><link rel="prefetch" href="/assets/js/281.7d70ccb4.js"><link rel="prefetch" href="/assets/js/282.6f977d09.js"><link rel="prefetch" href="/assets/js/283.a1a3961b.js"><link rel="prefetch" href="/assets/js/284.0cc3a88d.js"><link rel="prefetch" href="/assets/js/285.ac2aa22c.js"><link rel="prefetch" href="/assets/js/286.62986a24.js"><link rel="prefetch" href="/assets/js/287.af36ae8c.js"><link rel="prefetch" href="/assets/js/288.0e2fe765.js"><link rel="prefetch" href="/assets/js/289.3564ceaf.js"><link rel="prefetch" href="/assets/js/29.89ce61b5.js"><link rel="prefetch" href="/assets/js/290.f9b09a95.js"><link rel="prefetch" href="/assets/js/291.9b3a9a57.js"><link rel="prefetch" href="/assets/js/292.85dc7aa1.js"><link rel="prefetch" href="/assets/js/293.06642a16.js"><link rel="prefetch" href="/assets/js/294.e24caa94.js"><link rel="prefetch" href="/assets/js/295.b6630c82.js"><link rel="prefetch" href="/assets/js/296.d5fc6e7c.js"><link rel="prefetch" href="/assets/js/297.bcad016d.js"><link rel="prefetch" href="/assets/js/298.e9a67a4f.js"><link rel="prefetch" href="/assets/js/299.2d14da00.js"><link rel="prefetch" href="/assets/js/3.17f360d0.js"><link rel="prefetch" href="/assets/js/30.d1aa8054.js"><link rel="prefetch" href="/assets/js/300.9b6f85d0.js"><link rel="prefetch" href="/assets/js/301.baabd774.js"><link rel="prefetch" href="/assets/js/302.8a5bfa2c.js"><link rel="prefetch" href="/assets/js/303.0552127d.js"><link rel="prefetch" href="/assets/js/304.81bed0dd.js"><link rel="prefetch" href="/assets/js/305.db90e4bf.js"><link rel="prefetch" href="/assets/js/306.b2e515b7.js"><link rel="prefetch" href="/assets/js/307.8a0e359e.js"><link rel="prefetch" href="/assets/js/308.360167d7.js"><link rel="prefetch" href="/assets/js/309.1f88b629.js"><link rel="prefetch" href="/assets/js/31.2b4287b8.js"><link rel="prefetch" href="/assets/js/310.149fcb47.js"><link rel="prefetch" href="/assets/js/311.7a6b7e94.js"><link rel="prefetch" href="/assets/js/312.4f1bbcb2.js"><link rel="prefetch" href="/assets/js/313.ed0a9e5c.js"><link rel="prefetch" href="/assets/js/314.21919778.js"><link rel="prefetch" href="/assets/js/315.61c57cff.js"><link rel="prefetch" href="/assets/js/316.ae4287ac.js"><link rel="prefetch" href="/assets/js/317.5a06e49e.js"><link rel="prefetch" href="/assets/js/318.5c91e85c.js"><link rel="prefetch" href="/assets/js/319.4c6dc25b.js"><link rel="prefetch" href="/assets/js/32.f7174bfe.js"><link rel="prefetch" href="/assets/js/320.e63ef187.js"><link rel="prefetch" href="/assets/js/321.19e6d42f.js"><link rel="prefetch" href="/assets/js/322.80170711.js"><link rel="prefetch" href="/assets/js/323.7e9c3cdc.js"><link rel="prefetch" href="/assets/js/324.286b2957.js"><link rel="prefetch" href="/assets/js/325.9bca4d0d.js"><link rel="prefetch" href="/assets/js/326.182d121f.js"><link rel="prefetch" href="/assets/js/327.dd5929c0.js"><link rel="prefetch" href="/assets/js/328.60107055.js"><link rel="prefetch" href="/assets/js/329.422533d7.js"><link rel="prefetch" href="/assets/js/33.ee922c4d.js"><link rel="prefetch" href="/assets/js/330.c6c2a508.js"><link rel="prefetch" href="/assets/js/331.c80d9de5.js"><link rel="prefetch" href="/assets/js/332.eb0af05f.js"><link rel="prefetch" href="/assets/js/333.61c3117a.js"><link rel="prefetch" href="/assets/js/334.36894e06.js"><link rel="prefetch" href="/assets/js/335.7ba144e9.js"><link rel="prefetch" href="/assets/js/336.5cd831f9.js"><link rel="prefetch" href="/assets/js/337.54b04ae2.js"><link rel="prefetch" href="/assets/js/338.65b1a3c1.js"><link rel="prefetch" href="/assets/js/339.808d3284.js"><link rel="prefetch" href="/assets/js/34.de720458.js"><link rel="prefetch" href="/assets/js/340.75befd5d.js"><link rel="prefetch" href="/assets/js/341.8f35cb19.js"><link rel="prefetch" href="/assets/js/342.df708318.js"><link rel="prefetch" href="/assets/js/343.fce19338.js"><link rel="prefetch" href="/assets/js/344.c1a3920f.js"><link rel="prefetch" href="/assets/js/345.d0675e31.js"><link rel="prefetch" href="/assets/js/346.fdf08890.js"><link rel="prefetch" href="/assets/js/347.8274a5b6.js"><link rel="prefetch" href="/assets/js/348.9dd931a4.js"><link rel="prefetch" href="/assets/js/349.254fe21d.js"><link rel="prefetch" href="/assets/js/35.4454ea43.js"><link rel="prefetch" href="/assets/js/350.941e7270.js"><link rel="prefetch" href="/assets/js/351.94e380ac.js"><link rel="prefetch" href="/assets/js/352.841dd34f.js"><link rel="prefetch" href="/assets/js/353.ba4b3072.js"><link rel="prefetch" href="/assets/js/354.2ddd6766.js"><link rel="prefetch" href="/assets/js/355.e66c7289.js"><link rel="prefetch" href="/assets/js/356.920b3ebb.js"><link rel="prefetch" href="/assets/js/357.dca11ccb.js"><link rel="prefetch" href="/assets/js/358.7ec2160b.js"><link rel="prefetch" href="/assets/js/359.f4b533d1.js"><link rel="prefetch" href="/assets/js/36.d9c2a9db.js"><link rel="prefetch" href="/assets/js/360.bd21b670.js"><link rel="prefetch" href="/assets/js/361.52ffa5a1.js"><link rel="prefetch" href="/assets/js/362.68ba7cdd.js"><link rel="prefetch" href="/assets/js/363.78cc63b6.js"><link rel="prefetch" href="/assets/js/364.452e6e03.js"><link rel="prefetch" href="/assets/js/365.a5bf58af.js"><link rel="prefetch" href="/assets/js/366.a2652a53.js"><link rel="prefetch" href="/assets/js/367.df61be65.js"><link rel="prefetch" href="/assets/js/368.b68bb759.js"><link rel="prefetch" href="/assets/js/369.fdab3f73.js"><link rel="prefetch" href="/assets/js/37.2e8cbe24.js"><link rel="prefetch" href="/assets/js/370.ce53a7bb.js"><link rel="prefetch" href="/assets/js/371.dc258d49.js"><link rel="prefetch" href="/assets/js/372.0b1edb7e.js"><link rel="prefetch" href="/assets/js/373.98063c74.js"><link rel="prefetch" href="/assets/js/374.51d40903.js"><link rel="prefetch" href="/assets/js/375.f87599bb.js"><link rel="prefetch" href="/assets/js/376.e3dc8984.js"><link rel="prefetch" href="/assets/js/377.c5079600.js"><link rel="prefetch" href="/assets/js/378.e3dcf9fd.js"><link rel="prefetch" href="/assets/js/379.ddf55724.js"><link rel="prefetch" href="/assets/js/38.1913a7d7.js"><link rel="prefetch" href="/assets/js/380.868298bf.js"><link rel="prefetch" href="/assets/js/381.47029fa4.js"><link rel="prefetch" href="/assets/js/382.1323e975.js"><link rel="prefetch" href="/assets/js/383.ac7f1567.js"><link rel="prefetch" href="/assets/js/384.3eb329f8.js"><link rel="prefetch" href="/assets/js/385.9e349f5e.js"><link rel="prefetch" href="/assets/js/386.ef40ce05.js"><link rel="prefetch" href="/assets/js/387.6c362542.js"><link rel="prefetch" href="/assets/js/388.524cd102.js"><link rel="prefetch" href="/assets/js/389.296b706c.js"><link rel="prefetch" href="/assets/js/39.5aed1637.js"><link rel="prefetch" href="/assets/js/390.6c6d77d1.js"><link rel="prefetch" href="/assets/js/391.c6556dad.js"><link rel="prefetch" href="/assets/js/392.f6c05801.js"><link rel="prefetch" href="/assets/js/393.10b84c25.js"><link rel="prefetch" href="/assets/js/394.7edec3a1.js"><link rel="prefetch" href="/assets/js/395.7c5029b8.js"><link rel="prefetch" href="/assets/js/396.a1a62605.js"><link rel="prefetch" href="/assets/js/397.be9e9cf5.js"><link rel="prefetch" href="/assets/js/398.372e1855.js"><link rel="prefetch" href="/assets/js/399.494167f8.js"><link rel="prefetch" href="/assets/js/40.9614bca4.js"><link rel="prefetch" href="/assets/js/400.18f13f62.js"><link rel="prefetch" href="/assets/js/401.ec29b9ae.js"><link rel="prefetch" href="/assets/js/402.b4b3ed10.js"><link rel="prefetch" href="/assets/js/403.dacb6823.js"><link rel="prefetch" href="/assets/js/404.bd7b3e65.js"><link rel="prefetch" href="/assets/js/405.252618e9.js"><link rel="prefetch" href="/assets/js/406.ab258b56.js"><link rel="prefetch" href="/assets/js/407.fc91b307.js"><link rel="prefetch" href="/assets/js/408.1f61bbb4.js"><link rel="prefetch" href="/assets/js/409.63457ce7.js"><link rel="prefetch" href="/assets/js/41.4c9121f8.js"><link rel="prefetch" href="/assets/js/410.d7596150.js"><link rel="prefetch" href="/assets/js/411.06cf9614.js"><link rel="prefetch" href="/assets/js/412.b54366dd.js"><link rel="prefetch" href="/assets/js/413.3e89e98b.js"><link rel="prefetch" href="/assets/js/414.b0f580d6.js"><link rel="prefetch" href="/assets/js/415.3bad3c01.js"><link rel="prefetch" href="/assets/js/416.a3510681.js"><link rel="prefetch" href="/assets/js/417.2c5d1142.js"><link rel="prefetch" href="/assets/js/418.87d22ee2.js"><link rel="prefetch" href="/assets/js/419.ba41b959.js"><link rel="prefetch" href="/assets/js/42.94741244.js"><link rel="prefetch" href="/assets/js/420.add76658.js"><link rel="prefetch" href="/assets/js/421.9bdf7fe7.js"><link rel="prefetch" href="/assets/js/422.8d07f71e.js"><link rel="prefetch" href="/assets/js/423.f28f89c1.js"><link rel="prefetch" href="/assets/js/424.60811254.js"><link rel="prefetch" href="/assets/js/425.2319dbe6.js"><link rel="prefetch" href="/assets/js/426.4b80d3d9.js"><link rel="prefetch" href="/assets/js/427.49de3f3e.js"><link rel="prefetch" href="/assets/js/428.fb29b2a8.js"><link rel="prefetch" href="/assets/js/429.0cae4902.js"><link rel="prefetch" href="/assets/js/43.0d7c9098.js"><link rel="prefetch" href="/assets/js/430.17d2231a.js"><link rel="prefetch" href="/assets/js/431.6954bf71.js"><link rel="prefetch" href="/assets/js/432.053b873f.js"><link rel="prefetch" href="/assets/js/433.9e0c2d89.js"><link rel="prefetch" href="/assets/js/434.504050de.js"><link rel="prefetch" href="/assets/js/435.837dce81.js"><link rel="prefetch" href="/assets/js/436.8bbc738e.js"><link rel="prefetch" href="/assets/js/437.a4fc45e7.js"><link rel="prefetch" href="/assets/js/438.bf255804.js"><link rel="prefetch" href="/assets/js/439.364a3d38.js"><link rel="prefetch" href="/assets/js/44.49b4ebc7.js"><link rel="prefetch" href="/assets/js/440.c6d5f478.js"><link rel="prefetch" href="/assets/js/441.ba50046b.js"><link rel="prefetch" href="/assets/js/442.3bce92c3.js"><link rel="prefetch" href="/assets/js/443.00c98cfe.js"><link rel="prefetch" href="/assets/js/444.5664322e.js"><link rel="prefetch" href="/assets/js/445.877f66a1.js"><link rel="prefetch" href="/assets/js/446.aa840c2f.js"><link rel="prefetch" href="/assets/js/447.b026ffb2.js"><link rel="prefetch" href="/assets/js/448.b28aa71a.js"><link rel="prefetch" href="/assets/js/449.48f8eff1.js"><link rel="prefetch" href="/assets/js/45.03dfcebf.js"><link rel="prefetch" href="/assets/js/450.28853153.js"><link rel="prefetch" href="/assets/js/451.19d0767a.js"><link rel="prefetch" href="/assets/js/452.f8878832.js"><link rel="prefetch" href="/assets/js/453.281e0135.js"><link rel="prefetch" href="/assets/js/454.3431cf32.js"><link rel="prefetch" href="/assets/js/455.71a68d78.js"><link rel="prefetch" href="/assets/js/456.bfb0c6b5.js"><link rel="prefetch" href="/assets/js/457.9effc9c6.js"><link rel="prefetch" href="/assets/js/458.75b4a9e0.js"><link rel="prefetch" href="/assets/js/459.dc2ee8a9.js"><link rel="prefetch" href="/assets/js/46.2cae6041.js"><link rel="prefetch" href="/assets/js/460.c875a9e6.js"><link rel="prefetch" href="/assets/js/461.6973d8d5.js"><link rel="prefetch" href="/assets/js/462.efe609b9.js"><link rel="prefetch" href="/assets/js/463.760957a6.js"><link rel="prefetch" href="/assets/js/464.bc530c49.js"><link rel="prefetch" href="/assets/js/465.329a71e6.js"><link rel="prefetch" href="/assets/js/466.b1557f33.js"><link rel="prefetch" href="/assets/js/467.da228937.js"><link rel="prefetch" href="/assets/js/468.3afb2ecf.js"><link rel="prefetch" href="/assets/js/469.b5e5e142.js"><link rel="prefetch" href="/assets/js/47.4d8b752a.js"><link rel="prefetch" href="/assets/js/470.9905d72e.js"><link rel="prefetch" href="/assets/js/471.e10e3102.js"><link rel="prefetch" href="/assets/js/472.7477c1b0.js"><link rel="prefetch" href="/assets/js/473.10527fde.js"><link rel="prefetch" href="/assets/js/474.24ed3c8d.js"><link rel="prefetch" href="/assets/js/475.9c283a73.js"><link rel="prefetch" href="/assets/js/476.ecd2ad0e.js"><link rel="prefetch" href="/assets/js/477.a9c10c46.js"><link rel="prefetch" href="/assets/js/478.5ca857f6.js"><link rel="prefetch" href="/assets/js/479.057c929a.js"><link rel="prefetch" href="/assets/js/48.2133e19b.js"><link rel="prefetch" href="/assets/js/480.f6a0b718.js"><link rel="prefetch" href="/assets/js/481.2a9514fb.js"><link rel="prefetch" href="/assets/js/482.19e10a70.js"><link rel="prefetch" href="/assets/js/483.72d185e1.js"><link rel="prefetch" href="/assets/js/484.bd878cf9.js"><link rel="prefetch" href="/assets/js/485.0b7a3680.js"><link rel="prefetch" href="/assets/js/486.738508de.js"><link rel="prefetch" href="/assets/js/487.a28376ba.js"><link rel="prefetch" href="/assets/js/488.27a265da.js"><link rel="prefetch" href="/assets/js/489.df9b7df2.js"><link rel="prefetch" href="/assets/js/49.b40fa721.js"><link rel="prefetch" href="/assets/js/490.b00c77e7.js"><link rel="prefetch" href="/assets/js/491.8ce596f8.js"><link rel="prefetch" href="/assets/js/492.6da0b951.js"><link rel="prefetch" href="/assets/js/493.194142a4.js"><link rel="prefetch" href="/assets/js/494.525df756.js"><link rel="prefetch" href="/assets/js/495.98e87f8b.js"><link rel="prefetch" href="/assets/js/496.38003e2d.js"><link rel="prefetch" href="/assets/js/497.b0a8634b.js"><link rel="prefetch" href="/assets/js/498.b58d6c6f.js"><link rel="prefetch" href="/assets/js/499.8d7790f2.js"><link rel="prefetch" href="/assets/js/5.5e361e5e.js"><link rel="prefetch" href="/assets/js/50.764cf6f8.js"><link rel="prefetch" href="/assets/js/500.74246557.js"><link rel="prefetch" href="/assets/js/501.69865b84.js"><link rel="prefetch" href="/assets/js/502.8a5aadec.js"><link rel="prefetch" href="/assets/js/504.99a194f4.js"><link rel="prefetch" href="/assets/js/505.ba8e9f9a.js"><link rel="prefetch" href="/assets/js/506.62b81c0a.js"><link rel="prefetch" href="/assets/js/507.28abce36.js"><link rel="prefetch" href="/assets/js/508.29669b9c.js"><link rel="prefetch" href="/assets/js/509.9878a033.js"><link rel="prefetch" href="/assets/js/51.81b21a23.js"><link rel="prefetch" href="/assets/js/510.05d83afc.js"><link rel="prefetch" href="/assets/js/511.eb3195ff.js"><link rel="prefetch" href="/assets/js/512.a7002238.js"><link rel="prefetch" href="/assets/js/513.22a7f09a.js"><link rel="prefetch" href="/assets/js/514.75f4d771.js"><link rel="prefetch" href="/assets/js/515.8584e42f.js"><link rel="prefetch" href="/assets/js/516.7a30e6b6.js"><link rel="prefetch" href="/assets/js/517.a9f3a2fd.js"><link rel="prefetch" href="/assets/js/518.c38887f9.js"><link rel="prefetch" href="/assets/js/519.7cd822e2.js"><link rel="prefetch" href="/assets/js/52.b1ffb904.js"><link rel="prefetch" href="/assets/js/520.e73e7ff9.js"><link rel="prefetch" href="/assets/js/521.9ab850a5.js"><link rel="prefetch" href="/assets/js/522.f6751bd1.js"><link rel="prefetch" href="/assets/js/523.6f627afc.js"><link rel="prefetch" href="/assets/js/524.c060952e.js"><link rel="prefetch" href="/assets/js/525.6f2a5f32.js"><link rel="prefetch" href="/assets/js/526.7c2ab23e.js"><link rel="prefetch" href="/assets/js/527.36f20115.js"><link rel="prefetch" href="/assets/js/528.6be037b0.js"><link rel="prefetch" href="/assets/js/529.91d25836.js"><link rel="prefetch" href="/assets/js/53.bcbeb201.js"><link rel="prefetch" href="/assets/js/530.efb60ab9.js"><link rel="prefetch" href="/assets/js/531.989c79c0.js"><link rel="prefetch" href="/assets/js/532.e840b5c1.js"><link rel="prefetch" href="/assets/js/533.a71ba3c3.js"><link rel="prefetch" href="/assets/js/534.c35d83bf.js"><link rel="prefetch" href="/assets/js/535.a1792b22.js"><link rel="prefetch" href="/assets/js/536.4613ebf6.js"><link rel="prefetch" href="/assets/js/537.d48f5626.js"><link rel="prefetch" href="/assets/js/538.db962bd6.js"><link rel="prefetch" href="/assets/js/539.617c1259.js"><link rel="prefetch" href="/assets/js/54.d684ca2d.js"><link rel="prefetch" href="/assets/js/540.17f0f7cc.js"><link rel="prefetch" href="/assets/js/541.6904dd50.js"><link rel="prefetch" href="/assets/js/542.d1d9119e.js"><link rel="prefetch" href="/assets/js/55.8a30377a.js"><link rel="prefetch" href="/assets/js/56.b68c0d3c.js"><link rel="prefetch" href="/assets/js/57.07c8c60e.js"><link rel="prefetch" href="/assets/js/58.447581b8.js"><link rel="prefetch" href="/assets/js/59.80f69fa5.js"><link rel="prefetch" href="/assets/js/6.d326a394.js"><link rel="prefetch" href="/assets/js/60.6268fb7c.js"><link rel="prefetch" href="/assets/js/61.4f37698f.js"><link rel="prefetch" href="/assets/js/62.f7ce00d9.js"><link rel="prefetch" href="/assets/js/63.8b5c4639.js"><link rel="prefetch" href="/assets/js/64.23f5b95c.js"><link rel="prefetch" href="/assets/js/65.4985d24b.js"><link rel="prefetch" href="/assets/js/66.f3358479.js"><link rel="prefetch" href="/assets/js/67.a404dc7c.js"><link rel="prefetch" href="/assets/js/68.4867dcf5.js"><link rel="prefetch" href="/assets/js/69.e6533bdf.js"><link rel="prefetch" href="/assets/js/7.89860eb3.js"><link rel="prefetch" href="/assets/js/70.d6581cb5.js"><link rel="prefetch" href="/assets/js/71.46199338.js"><link rel="prefetch" href="/assets/js/72.c74e5c3e.js"><link rel="prefetch" href="/assets/js/73.a9a3aa2f.js"><link rel="prefetch" href="/assets/js/74.d832c7a1.js"><link rel="prefetch" href="/assets/js/75.337ed40c.js"><link rel="prefetch" href="/assets/js/76.39b2c04e.js"><link rel="prefetch" href="/assets/js/77.01ba5622.js"><link rel="prefetch" href="/assets/js/78.b211f414.js"><link rel="prefetch" href="/assets/js/79.1fe9a2c0.js"><link rel="prefetch" href="/assets/js/8.54c6c177.js"><link rel="prefetch" href="/assets/js/80.ecf976f6.js"><link rel="prefetch" href="/assets/js/81.8c22e86c.js"><link rel="prefetch" href="/assets/js/82.79d6812b.js"><link rel="prefetch" href="/assets/js/83.e8b79a8d.js"><link rel="prefetch" href="/assets/js/84.46bbb939.js"><link rel="prefetch" href="/assets/js/85.360cccc1.js"><link rel="prefetch" href="/assets/js/86.99309a51.js"><link rel="prefetch" href="/assets/js/87.eb2628ba.js"><link rel="prefetch" href="/assets/js/88.48c3b7aa.js"><link rel="prefetch" href="/assets/js/89.b3d56b26.js"><link rel="prefetch" href="/assets/js/9.061a1f3f.js"><link rel="prefetch" href="/assets/js/90.530573e8.js"><link rel="prefetch" href="/assets/js/91.0b43a13c.js"><link rel="prefetch" href="/assets/js/92.5978b6b1.js"><link rel="prefetch" href="/assets/js/93.0152dcb5.js"><link rel="prefetch" href="/assets/js/94.e6697216.js"><link rel="prefetch" href="/assets/js/95.402c7586.js"><link rel="prefetch" href="/assets/js/96.a8fe31d7.js"><link rel="prefetch" href="/assets/js/97.1f54b8d2.js"><link rel="prefetch" href="/assets/js/98.d3133590.js"><link rel="prefetch" href="/assets/js/99.0e23148c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.ef7cd65c.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/logo.png" alt="KNOTE" class="logo"> <span class="site-name can-hide">KNOTE</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/note/" class="nav-link">导航</a></div><div class="nav-item"><a href="/whell/web/" class="nav-link">收藏</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li></ul></div></div> <a href="https://github.com/micolor" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/img/avatar.png"> <div class="blogger-info"><h3>AnWen</h3> <span>积跬步以至千里</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/note/" class="nav-link">导航</a></div><div class="nav-item"><a href="/whell/web/" class="nav-link">收藏</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/pages/f2a556/" class="nav-link">学习</a></li><li class="dropdown-item"><!----> <a href="/pages/baaa02/" class="nav-link">实用技巧</a></li><li class="dropdown-item"><!----> <a href="/about/" class="nav-link">关于</a></li></ul></div></div> <a href="https://github.com/micolor" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>容器Kubernetes</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/466191/#kubernetes概述" class="sidebar-link">Kubernetes概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/466191/#kubernetes介绍" class="sidebar-link">Kubernetes介绍</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#kubernetes是什么及作用" class="sidebar-link">Kubernetes是什么及作用</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#使用kubernetes能做什么" class="sidebar-link">使用Kubernetes能做什么</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#为什么使用kubernetes" class="sidebar-link">为什么使用Kubernetes</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#kubernetes快速入门" class="sidebar-link">Kubernetes快速入门</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#kubernetes-基本架构与常用术语" class="sidebar-link">Kubernetes 基本架构与常用术语</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#cluster" class="sidebar-link">Cluster</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#master" class="sidebar-link">Master</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#node" class="sidebar-link">Node</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#pod" class="sidebar-link">Pod</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#service" class="sidebar-link">Service</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#replication-controller" class="sidebar-link">Replication Controller</a></li></ul></li><li><a href="/pages/466191/#kubernetes集群" class="sidebar-link">Kubernetes集群</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/466191/#环境准备与规划" class="sidebar-link">环境准备与规划</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#master安装" class="sidebar-link">Master安装</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#docker安装" class="sidebar-link">Docker安装</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#etcd服务" class="sidebar-link">etcd服务</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#kube-apiserver服务" class="sidebar-link">kube-apiserver服务</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#kube-controller-manager服务" class="sidebar-link">kube-controller-manager服务</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#kube-scheduler服务" class="sidebar-link">kube-scheduler服务</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#启动" class="sidebar-link">启动</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#node1安装" class="sidebar-link">Node1安装</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#kubelet服务" class="sidebar-link">kubelet服务</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#kube-proxy服务" class="sidebar-link">kube-proxy服务</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#启动-2" class="sidebar-link">启动</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#node2安装" class="sidebar-link">Node2安装</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#健康检查与示例测试" class="sidebar-link">健康检查与示例测试</a></li></ul></li><li><a href="/pages/466191/#kubernetes核心技术" class="sidebar-link">Kubernetes核心技术</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/466191/#pod详解" class="sidebar-link">Pod详解</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#pod的定义" class="sidebar-link">Pod的定义</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#_3-1-2-pod的基本用法" class="sidebar-link">3.1.2 Pod的基本用法</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#_3-1-3-pod的分类" class="sidebar-link">3.1.3 Pod的分类</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#pod生命周期和重启策略" class="sidebar-link">Pod生命周期和重启策略</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#pod资源配置" class="sidebar-link">Pod资源配置</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#label详解" class="sidebar-link">Label详解</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#replication-controller详解" class="sidebar-link">Replication Controller详解</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#replica-set详解" class="sidebar-link">Replica Set详解</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#deployment详解" class="sidebar-link">Deployment详解</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#horizontal-pod-autoscaler" class="sidebar-link">Horizontal Pod Autoscaler</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#volume详解" class="sidebar-link">Volume详解</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#namespace详解" class="sidebar-link">Namespace详解</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#service-详解" class="sidebar-link">Service 详解</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#service的定义" class="sidebar-link">Service的定义</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#service的基本用法" class="sidebar-link">Service的基本用法</a></li></ul></li><li><a href="/pages/466191/#总结" class="sidebar-link">总结</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/466191/#k8s架构和组件" class="sidebar-link">K8S架构和组件</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#master-2" class="sidebar-link">Master</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#node-2" class="sidebar-link">Node</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#k8s集群搭建常见问题" class="sidebar-link">K8S集群搭建常见问题</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#docker启动失败" class="sidebar-link">docker启动失败</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#解决-kubectl-get-pods时no-resources-found问题" class="sidebar-link">解决 kubectl get pods时No resources found问题</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#pull-失败" class="sidebar-link">pull 失败</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#解决内外可以访问外网无法访问" class="sidebar-link">解决内外可以访问外网无法访问</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#根据报错日志排查并解决集群中启动遇到的问题" class="sidebar-link">根据报错日志排查并解决集群中启动遇到的问题</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#the-connection-to-the-server-localhost-8080-was-refused-did-you-specify-the-right-host-or-port" class="sidebar-link">The connection to the server localhost:8080 was refused - did you specify the right host or port?</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#pod状态一直pending" class="sidebar-link">pod状态一直pending</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#unexpected-error-getting-claim-reference-selflink-was-empty-can-t-make-reference" class="sidebar-link">unexpected error getting claim reference: selfLink was empty, can't make reference</a></li></ul></li><li><a href="/pages/466191/#常用命令" class="sidebar-link">常用命令</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/466191/#防火墙相关" class="sidebar-link">防火墙相关</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/466191/#安装手册" class="sidebar-link">安装手册</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/466191/#centos8上部署kubernetes" class="sidebar-link">Centos8上部署kubernetes</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/466191/#查看系统版本" class="sidebar-link">查看系统版本</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#配置网络" class="sidebar-link">配置网络</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#添加阿里源" class="sidebar-link">添加阿里源</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#配置主机名" class="sidebar-link">配置主机名</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#安装常用包" class="sidebar-link">安装常用包</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#使用aliyun源安装docker-ce" class="sidebar-link">使用aliyun源安装docker-ce</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#安装kubectl、kubelet、kubeadm" class="sidebar-link">安装kubectl、kubelet、kubeadm</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#添加阿里kubernetes源" class="sidebar-link">添加阿里kubernetes源</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#安装" class="sidebar-link">安装</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#初始化k8s集群" class="sidebar-link">初始化k8s集群</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#使kubectl可以自动补充" class="sidebar-link">使kubectl可以自动补充</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#安装calico网络" class="sidebar-link">安装calico网络</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#节点加入集群" class="sidebar-link">节点加入集群</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#创建token-token有效时间24h" class="sidebar-link">创建token，token有效时间24h</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#查看token" class="sidebar-link">查看token</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#获取ca证书sha256编码hash值" class="sidebar-link">获取ca证书sha256编码hash值</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#节点加入集群-2" class="sidebar-link">节点加入集群</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#节点查看" class="sidebar-link">节点查看</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#master加入集群" class="sidebar-link">master加入集群</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#设置免密登录" class="sidebar-link">设置免密登录</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#同步相关证书脚本" class="sidebar-link">同步相关证书脚本</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#节点加入集群-3" class="sidebar-link">节点加入集群</a></li></ul></li><li><a href="/pages/466191/#安装helm" class="sidebar-link">安装Helm</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/466191/#创建权限" class="sidebar-link">创建权限</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#下载安装包并安装" class="sidebar-link">下载安装包并安装</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#验证-helm-或-tiller" class="sidebar-link">验证 helm 或 tiller</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#检查-tiller-是否部署到-k8s" class="sidebar-link">检查 tiller 是否部署到 k8s</a></li><li class="sidebar-sub-header level3"><a href="/pages/466191/#安装openebs" class="sidebar-link">安装openEBS</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#安装-2" class="sidebar-link">安装</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#验证等待安装完成" class="sidebar-link">验证等待安装完成</a></li><li class="sidebar-sub-header level4"><a href="/pages/466191/#将-openebs-hostpath设置为默认的-storageclass" class="sidebar-link">将 openebs-hostpath设置为默认的 StorageClass</a></li></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><!----> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://www.niubook.com" target="_blank" title="作者" class="beLink" data-v-06225672>KNOTE </a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2021-01-03</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">容器Kubernetes<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h2 id="kubernetes概述"><a href="#kubernetes概述" class="header-anchor">#</a> Kubernetes概述</h2> <h3 id="kubernetes介绍"><a href="#kubernetes介绍" class="header-anchor">#</a> Kubernetes介绍</h3> <h4 id="kubernetes是什么及作用"><a href="#kubernetes是什么及作用" class="header-anchor">#</a> Kubernetes是什么及作用</h4> <p>Kubernetes(K8S)是Google在2014年发布的一个开源项目，用于自动化容器化应用程序的部署、扩展和管理。 Kubernetes通常结合docker容器工作，并且整合多个运行着docker容器的主机集群。 官网地址 https://Kubernetes.io</p> <p>中文社区 https://www.kubernetes.org.cn/docs</p> <p>Kubernetes的目标是让部署容器化的应用简单并且高效，Kubernetes一个核心特点就是能够自主的管理容器来保 证云平台中的容器按照用户的期望运行。以下是Kubernetes相关特性：</p> <ul><li><p>自动包装</p> <p>根据资源需求和其他约束自动放置容器，同时不会牺牲可用性，混合关键和最大努力的工作负载，以提高资 源利用率并节省更多资源。</p></li> <li><p>横向缩放</p> <p>使用简单的命令或 UI，或者根据 CPU 的使用情况自动调整应用程序副本数。</p></li> <li><p>自动部署和回滚</p> <p>Kubernetes 逐渐部署对应用程序或其配置的更改，同时监视应用程序运行状况，以确保它不会同时终止所有 实例。 如果出现问题，Kubernetes会为您恢复更改，利用日益增长的部署解决方案的生态系统。</p></li> <li><p>存储编排</p></li></ul> <p>自动安装您所选择的存储系统，无论是本地存储，如公有云提供商 GCP 或 AWS, 还是网络存储系统 NFS, iSCSI, Gluster, Ceph, Cinder, 或 Flocker。</p> <ul><li><p>自我修复</p> <p>重新启动失败的容器，在节点不可用时，替换和重新编排节点上的容器，终止不对用户定义的健康检查做出 响应的容器，并且不会在客户端准备投放之前将其通告给客户端。</p></li> <li><p>服务发现和负载均衡</p> <p>不需要修改您的应用程序来使用不熟悉的服务发现机制，Kubernetes 为容器提供了自己的 IP 地址和一组容 器的单个 DNS 名称，并可以在它们之间进行负载均衡。</p></li> <li><p>密钥和配置管理</p> <p>部署和更新密钥和应用程序配置，不会重新编译您的镜像，不会在堆栈配置中暴露密钥(secrets)。</p></li> <li><p>批处理</p> <p>除了服务之外，Kubernetes还可以管理您的批处理和 CI 工作负载，如果需要，替换出现故障的容器。</p></li></ul> <h4 id="使用kubernetes能做什么"><a href="#使用kubernetes能做什么" class="header-anchor">#</a> 使用Kubernetes能做什么</h4> <p>Kubernetes是一个全新的基于容器技术的分布式架构领先方案（源于Brog，是google十几年经验的结晶）； Kubernetes是一个开放的开发平台（无侵入性，现有系统很容器迁移到Kubernetes上）；Kubernetes是一个完备 的分布式系统支撑平台（完善的集群管理能力）。</p> <p>使用Kubernetes可以在物理或虚拟机的Kubernetes集群上运行容器化应用，Kubernetes能够提供一个以容器为中 心的基础架构，满足在生产环境中运行应用的一些常见需求，如:</p> <ul><li>多个进程协同工作</li> <li>存储系统挂载</li> <li>Distributing secrets</li> <li>应用健康检测</li> <li>应用实例的复制</li> <li>Pod自动伸缩/扩展</li> <li>Naming and discovering</li> <li>负载均衡</li> <li>滚动更新</li> <li>资源监控</li> <li>日志访问</li> <li>调度应用程序</li> <li>提供认证和授权</li></ul> <h4 id="为什么使用kubernetes"><a href="#为什么使用kubernetes" class="header-anchor">#</a> 为什么使用Kubernetes</h4> <p>使用Kubernetes最直接的感受就是我们可以轻装上阵的开发复杂的系统了；其次Kubernetes是在全面拥抱微服务 架构（微服务的核心就是将一个巨大的单体应用拆分成很多小的互相连接的微服务，一个微服务后面可能是多个实 例副本在支撑，副本数量可以随着系统负荷的变化而动态调整）；最后Kubernetes系统架构具备超强的横向扩展 能力。</p> <h3 id="kubernetes快速入门"><a href="#kubernetes快速入门" class="header-anchor">#</a> Kubernetes快速入门</h3> <ul><li><p>环境准备</p> <p><strong>关闭CentOS防火墙</strong></p> <p><code>systemctl disable firewalld</code></p> <p><code>systemctl stop firewalld</code></p> <p><strong>安装etcd和kubernetes软件</strong></p> <p><code>yum install -y etcd kubernetes</code></p> <p><strong>启动服务</strong></p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>systemctl start etcd
systemctl start <span class="token function">docker</span>
systemctl start kube-apiserver
systemctl start kube-controller-manager
systemctl start kube-scheduler
systemctl start kubelet
systemctl start kube-proxy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>配置（tomcat）</p> <ul><li><p>mytomcat.rc.yaml</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> ReplicationController
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
<span class="token key atrule">name</span><span class="token punctuation">:</span> mytomcat
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
<span class="token key atrule">replicas</span><span class="token punctuation">:</span> <span class="token number">2</span>
<span class="token key atrule">selector</span><span class="token punctuation">:</span>
<span class="token key atrule">app</span><span class="token punctuation">:</span> mytomcat
<span class="token key atrule">template</span><span class="token punctuation">:</span>
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
 <span class="token key atrule">labels</span><span class="token punctuation">:</span>
  <span class="token key atrule">app</span><span class="token punctuation">:</span> mytomcat
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
 <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mytomcat
    <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">:</span>7<span class="token punctuation">-</span>jre7
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div></li> <li><p>mytomcat.svc.yaml</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">appVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Service
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
 <span class="token key atrule">name</span><span class="token punctuation">:</span> mytomcat
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
 <span class="token key atrule">type</span><span class="token punctuation">:</span> NodePort
 <span class="token key atrule">ports</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8080</span>
    <span class="token key atrule">nodePort</span><span class="token punctuation">:</span> <span class="token number">30001</span>
 <span class="token key atrule">selector</span><span class="token punctuation">:</span>
  <span class="token key atrule">app</span><span class="token punctuation">:</span> mytomcat
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>创建</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>kubectl create <span class="token parameter variable">-f</span> mytomcat.rc.yaml
kubectl create <span class="token parameter variable">-f</span> mytomcat.svc.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li> <li><p>浏览测试</p> <p><code>http://服务器地址:30001</code></p> <p><img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424147.png" alt="image-20210122220700871"></p></li></ul></li></ul> <h3 id="kubernetes-基本架构与常用术语"><a href="#kubernetes-基本架构与常用术语" class="header-anchor">#</a> Kubernetes 基本架构与常用术语</h3> <p>Kubernetes集群包含有节点代理kubelet和Master组件(APIs, scheduler, etc)，一切都基于分布式的存储系统。下 面这张图是Kubernetes的架构图。</p> <img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424148.png" alt="704717-20170304103633345-155330022" style="zoom:67%;"> <p>在这张系统架构图中，我们把服务分为运行在工作节点上的服务和组成集群级别控制板的服务。</p> <p>Kubernetes节点有运行应用容器必备的服务，而这些都是受Master的控制。</p> <p>每次个节点上当然都要运行Docker。Docker来负责所有具体的映像下载和容器运行。</p> <p>Kubernetes主要由以下几个核心组件组成：</p> <ul><li>etcd保存了整个集群的状态；</li> <li>apiserver提供了资源操作的唯一入口，并提供认证、授权、访问控制、API注册和发现等机制；</li> <li>controller manager负责维护集群的状态，比如故障检测、自动扩展、滚动更新等；</li> <li>scheduler负责资源的调度，按照预定的调度策略将Pod调度到相应的机器上；</li> <li>kubelet负责维护容器的生命周期，同时也负责Volume（CVI）和网络（CNI）的管理；</li> <li>Container runtime负责镜像管理以及Pod和容器的真正运行（CRI）；</li> <li>kube-proxy负责为Service提供cluster内部的服务发现和负载均衡；</li></ul> <p>除了核心组件，还有一些推荐的Add-ons：</p> <ul><li>kube-dns负责为整个集群提供DNS服务</li> <li>Ingress Controller为服务提供外网入口</li> <li>Heapster提供资源监控</li> <li>Dashboard提供GUI</li> <li>Federation提供跨可用区的集群</li> <li>Fluentd-elasticsearch提供集群日志采集、存储与查询</li></ul> <p>Kubernetes设计理念和功能其实就是一个类似Linux的分层架构</p> <ul><li><p>核心层：Kubernetes最核心的功能，对外提供API构建高层的应用，对内提供插件式应用执行环境</p></li> <li><p>应用层：部署（无状态应用、有状态应用、批处理任务、集群应用等）和路由（服务发现、DNS解析等）</p></li> <li><p>管理层：系统度量（如基础设施、容器和网络的度量），自动化（如自动扩展、动态Provision等）以及策略管理（RBAC、Quota、PSP、NetworkPolicy等）</p></li> <li><p>接口层：kubectl命令行工具、客户端SDK以及集群联邦</p></li> <li><p>生态系统：在接口层之上的庞大容器集群管理调度的生态系统，可以划分为两个范畴</p> <ul><li><p>Kubernetes外部：日志、监控、配置管理、CI、CD、Workflow、FaaS、OTS应用、ChatOps等</p></li> <li><p>Kubernetes内部：CRI、CNI、CVI、镜像仓库、Cloud Provider、集群自身的配置和管理等</p></li></ul></li></ul> <h4 id="cluster"><a href="#cluster" class="header-anchor">#</a> Cluster</h4> <p>Cluster是计算、存储和网络资源的集合，Kubernetes利用这些资源运行各种基于容器的应用. Kubernetes Cluster由Master和Node组成，节点上运行着若干Kubernetes服务</p> <h4 id="master"><a href="#master" class="header-anchor">#</a> Master</h4> <p>Master主要职责是调度，即决定将应用放在哪运行。Master运行Linux系统，可以是物理机或虚拟机。 Master是 Kubernetes Cluster的大脑，运行着的Daemon服务包括kube-apiserver、kube-scheduler、kuber-controllermanager、etcd和Pod网络</p> <ul><li><p>API Server(kube-apiserver)</p> <p>API Server 提供HTTP/HTTPS RESTful API,即Kubernetes API.是Kubernetes里所有资源的CRUD等操作的唯 一入口，也是集群控制的入口进程</p></li> <li><p>Scheduler(kube-scheduler)</p> <p>Scheduler负责资源调度的里程，简单说，它决定将Pod放在哪个Node上运行</p></li> <li><p>Controller Manager(kube-controller-manager)</p> <p>所有资源对象的自动化控制中心。Controller Manager负责管理Cluster各种资源，保证资源处于预期的状 态。Controller Manager有多种，如replication controller、endpoints controller、namespace controller、serviceaccounts controller等。 不同的controller管理不同的资源，如replication controller管理Deployment、StatefulSet、DaemonSet的 生命周期，namespace controller管理Namespace资源</p></li> <li><p>etcd</p> <p>etcd负责保存Kubernetes Cluster的配置信息和各种资源的状态信息。当数据发生变化时，etcd会快速地通知 Kubernetes相关组件</p></li> <li><p>Pod网络</p> <p>Pod要能够相互通信，Kubernetes Cluster必须部署Pod网络，flannel是其中一个可选方案。</p></li></ul> <h4 id="node"><a href="#node" class="header-anchor">#</a> Node</h4> <p>除了Master，Kubernetes集群中的其它机器被称为Node节点。Node职责是运行容器应用，Node由Master管 理，Node负责监控并汇报容器的状态，同时根据Master的要求管理容器的生命周期。Node也运行在Linux系统， 可以是物理机或虚拟机。 每个Node节点上都运行着以下一组关键进程</p> <ul><li><p>kubelet</p> <p>负责Pod对应的容器的创建、启动等任务，同时与Master节点密切协作，实现集群管理的基本功能</p></li> <li><p>kube-proxy</p> <p>实现Kubernetes Service的通信与负载均衡机制的重要组件</p></li> <li><p>Docker Enginer</p> <p>Docker引擎，负责本机的容器创建和管理工作</p></li></ul> <h4 id="pod"><a href="#pod" class="header-anchor">#</a> Pod</h4> <p>Pod是Kubernetes的最小单元，也是最重要和最基本的概念。每一个Pod包含一个或多个容器，Pod的容器会作为 一个整体被Master调度到一个Node上运行。Kubenetes为每个Pod都分配了唯一的IP地址，称为PodIP,一个Pod里的多个容器共享PodIP地址。在Kubernetes里，一个Pod里的容器与另外主机上的Pod容器能够直接通信。</p> <h4 id="service"><a href="#service" class="header-anchor">#</a> Service</h4> <p>Kubernetes Service定义了外界访问一组特定Pod的方式，Service有自己的IP和端口，Service为Pod提供了负载均 衡。它也是Kubernetes最核心的资源对象之一，每个Service其实就是我们经常提起的微服务架构中的一个&quot;微服务&quot;。</p> <h4 id="replication-controller"><a href="#replication-controller" class="header-anchor">#</a> Replication Controller</h4> <p>Replication Controller(简称RC)是Kubernetes系统中的核心概念之一，它其实是定义了一个期望的场景，即声明 某种Pod的副本数量在任意时刻都符合某个预期值，所以RC的定义包括如下几个部分</p> <ul><li>Pod期待的副本数(replicas)</li> <li>用于筛选目标Pod的Label Selector</li> <li>当Pod的副本数量小于预期数量时，用于创建新Pod的Pod模板(template)</li></ul> <p>以下是总结的RC的一些特性与作用</p> <p>在大多数情况下，我们通过定义一个RC实现Pod的创建过程及副本数量的自动控制</p> <ul><li>RC里包括完整的Pod定义模板</li> <li>RC通过Label Selector机制实现对Pod副本的自动控制</li> <li>通过改变RC里的Pod副本数量，可以实现Pod的扩容或缩容功能</li> <li>通过改变RC里Pod模板中镜像版本，可以实现Pod的滚动升级功能</li></ul> <h2 id="kubernetes集群"><a href="#kubernetes集群" class="header-anchor">#</a> Kubernetes集群</h2> <p>Kubernetes用于协调高度可用的计算机集群，这些计算机群集被连接作为单个单元工作。Kubernetes在一个集群上以更有效的方式自动分发和调度容器应用程序。Kubernetes集群由两种类型的资源组成：</p> <ul><li>Master是集群的调度节点</li> <li>Nodes是应用程序实际运行的工作节点</li></ul> <p>接下来为大家讲解一下如何快速部署一套Kubernetes集群，K8S集群部署有几种方式：kubeadm、minikube和二进制包。前两者属于自动部署，简化部署操作，我们这里强烈推荐初学者使用二进制包部署，因为自动部署屏蔽了很多细节，使得对各个模块感知很少，非常不利用学习。</p> <h3 id="环境准备与规划"><a href="#环境准备与规划" class="header-anchor">#</a> 环境准备与规划</h3> <ul><li><p>推荐配置2核2G</p> <p>Docker version 17.05.0-ce</p> <table><thead><tr><th>角色</th> <th>IP</th> <th>主键</th></tr></thead> <tbody><tr><td>master</td> <td>192.168.126.140</td> <td>etcd、kube-apiserver、kube-controller-manager、 kubescheduler、docker</td></tr> <tr><td>node01</td> <td>192.168.126.141</td> <td>kube-proxy、kubelet、docker</td></tr> <tr><td>node02</td> <td>192.168.126.142</td> <td>kube-proxy、kubelet、docker</td></tr></tbody></table></li> <li><p>查看默认防火墙状态(关闭后显示not running ,开启后显示 running)</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>firewall-cmd --state
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>关闭防火墙</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl stop firewalld.service
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>禁止firewall开机启动</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl disable firewalld.service
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>获取Kubernetes二进制包</p> <p>https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG-1.9.md</p> <p><img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424149.png" alt="360截图1766102110097133"></p> <p>页面表格中找到Server Binaries中的kubernetes-server-linux-amd64.tar.gz文件，下载到本地。</p> <p>该压缩包中包括了k8s需要运行的全部服务程序文件</p></li></ul> <h3 id="master安装"><a href="#master安装" class="header-anchor">#</a> Master安装</h3> <h4 id="docker安装"><a href="#docker安装" class="header-anchor">#</a> Docker安装</h4> <ul><li><p>设置yum源</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vi /etc/yum.repos.d/docker.repo
[dockerrepo]
name=Docker Repository
baseurl=https://yum.dockerproject.org/repo/main/centos/$releasever/
enabled=1
gpgcheck=1
gpgkey=https://yum.dockerproject.org/gpg
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div></li> <li><p>安装docke</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>yum install docker-engine
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>安装后查看docker版本</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker -v
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h4 id="etcd服务"><a href="#etcd服务" class="header-anchor">#</a> etcd服务</h4> <p>etcd做为Kubernetes集群的主要服务，在安装Kubernetes各服务前需要首先安装和启动。</p> <ul><li><p>下载etcd二进制文件</p> <p>https://github.com/etcd-io/etcd/releases</p> <p><img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424150.png" alt="360截图16780701879079"></p></li> <li><p>上传到master并解压</p> <p>将etcd和etcdctl文件复制到/usr/bin目录</p> <p>配置systemd服务文件 /usr/lib/systemd/system/etcd.service</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[Unit]
Description=Etcd Server
After=network.target
[Service]
Type=simple
EnvironmentFile=-/etc/etcd/etcd.conf
WorkingDirectory=/var/lib/etcd/
ExecStart=/usr/bin/etcd
Restart=on-failure
[Install]
WantedBy=multi-user.target
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div></li> <li><p>启动与测试etcd服务</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl daemon-reload
systemctl enable etcd.service
mkdir -p /var/lib/etcd/
systemctl start etcd.service
etcdctl cluster-health
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul> <h4 id="kube-apiserver服务"><a href="#kube-apiserver服务" class="header-anchor">#</a> kube-apiserver服务</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>cp kube-apiserver kube-controller-manager kube-scheduler kubectl /usr/bin/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>下面是对kube-apiserver服务进行配置</p> <p>编辑systemd服务文件 vi /usr/lib/systemd/system/kube-apiserver.service</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[Unit]
Description=Kubernetes API Server
Documentation=https://github.com/kubernetes/kubernetes
After=etcd.service
Wants=etcd.service
[Service]
EnvironmentFile=/etc/kubernetes/apiserver
ExecStart=/usr/bin/kube-apiserver $KUBE_API_ARGS
Restart=on-failure
Type=notify
[Install]
WantedBy=multi-user.target
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>创建目录： mkdir /etc/kubernetes</p> <p>配置文件 ：vi /etc/kubernetes/apiserver</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>KUBE_API_ARGS=&quot;--storage-backend=etcd3 --etcd-servers=http://127.0.0.1:2379 --insecure-bind-address=0.0.0.0 --insecure-port=8080 --service-cluster-ip-range=169.169.0.0/16 --admission_control=NamespaceLifecycle,NamespaceExists,LimitRanger,SecurityContextDeny,ServiceAccount,ResourceQuota --logtostderr=true --log-dir=/var/log/kubernetes --v=2&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="kube-controller-manager服务"><a href="#kube-controller-manager服务" class="header-anchor">#</a> kube-controller-manager服务</h4> <p>kube-controller-manager服务依赖于kube-apiserver服务：</p> <p>配置systemd服务文件：vi /usr/lib/systemd/system/kube-controller-manager.service</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[Unit]
Description=Kubernetes Controller Manager
Documentation=https://github.com/GoogleCloudPlatform/kubernetes
After=kube-apiserver.service
Requires=kube-apiserver.service
[Service]
EnvironmentFile=-/etc/kubernetes/controller-manager
ExecStart=/usr/bin/kube-controller-manager $KUBE_CONTROLLER_MANAGER_ARGS
Restart=on-failure
LimitNOFILE=65536
[Install]
WantedBy=multi-user.target
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>配置文件： vi /etc/kubernetes/controller-manager</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>KUBE_CONTROLLER_MANAGER_ARGS=&quot;--master=http://192.168.126.140:8080 --logtostderr=true --log-dir=/var/log/kubernetes --v=2&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="kube-scheduler服务"><a href="#kube-scheduler服务" class="header-anchor">#</a> kube-scheduler服务</h4> <p>kube-scheduler服务也依赖于kube-apiserver服务。</p> <p>配置systemd服务文件：vi /usr/lib/systemd/system/kube-scheduler.service</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[Unit]
Description=Kubernetes Scheduler
Documentation=https://github.com/GoogleCloudPlatform/kubernetes
After=kube-apiserver.service
Requires=kube-apiserver.service
[Service]
EnvironmentFile=-/etc/kubernetes/scheduler
ExecStart=/usr/bin/kube-scheduler $KUBE_SCHEDULER_ARGS
Restart=on-failure
LimitNOFILE=65536
[Install]
WantedBy=multi-user.target
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>配置文件：vi /etc/kubernetes/scheduler</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>KUBE_SCHEDULER_ARGS=&quot;--master=http://192.168.126.140:8080 --logtostderr=true --log-dir=/var/log/kubernetes --v=2&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="启动"><a href="#启动" class="header-anchor">#</a> 启动</h4> <p>完成以上配置后，按顺序启动服务</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl daemon-reload
systemctl enable kube-apiserver.service
systemctl start kube-apiserver.service
systemctl enable kube-controller-manager.service
systemctl start kube-controller-manager.service
systemctl enable kube-scheduler.service
systemctl start kube-scheduler.service
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>检查每个服务的健康状态：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl status kube-apiserver.service
systemctl status kube-controller-manager.service
systemctl status kube-scheduler.service
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="node1安装"><a href="#node1安装" class="header-anchor">#</a> Node1安装</h3> <p>在Node1节点上，以同样的方式把从压缩包中解压出的二进制文件kubelet kube-proxy放到/usr/bin目录中。</p> <p>在Node1节点上需要预先安装docker,请参考Master上Docker的安装，并启动Docker</p> <h4 id="kubelet服务"><a href="#kubelet服务" class="header-anchor">#</a> kubelet服务</h4> <p>配置systemd服务文件：vi /usr/lib/systemd/system/kubelet.service</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[Unit]
Description=Kubernetes Kubelet Server
Documentation=https://github.com/GoogleCloudPlatform/kubernetes
After=docker.service
Requires=docker.service
[Service]
WorkingDirectory=/var/lib/kubelet
EnvironmentFile=-/etc/kubernetes/kubelet
ExecStart=/usr/bin/kubelet $KUBELET_ARGS
Restart=on-failure
KillMode=process
[Install]
WantedBy=multi-user.target
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>创建目录：mkdir -p /var/lib/kubelet</p> <p>配置文件：vi /etc/kubernetes/kubelet</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>KUBELET_ARGS=&quot;--kubeconfig=/etc/kubernetes/kubeconfig --hostname-override=192.168.126.141 --logtostderr=false --log-dir=/var/log/kubernetes --v=2 --fail-swap-on=false&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>用于kubelet连接Master Apiserver的配置文件：vi /etc/kubernetes/kubeconfig</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: Config
clusters:
 - cluster:
     server: http://192.168.126.140:8080
   name: local
contexts:
  - context:
      cluster: local
    name: mycontext
current-context: mycontext
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="kube-proxy服务"><a href="#kube-proxy服务" class="header-anchor">#</a> kube-proxy服务</h4> <p>kube-proxy服务依赖于network服务,所以一定要保证network服务正常，如果network服务启动失败，常见解决方案有以下几中：</p> <ol><li>和 NetworkManager 服务有冲突，这个好解决，直接关闭 NetworkManger 服务就好了， service NetworkManager stop，并且禁止开机启动 chkconfig NetworkManager off 。之后重启就好了</li> <li>和配置文件的MAC地址不匹配，这个也好解决，使用ip addr（或ifconfig）查看mac地址， 将/etc/sysconfig/network-scripts/ifcfg-xxx中的HWADDR改为查看到的mac地址</li> <li>设定开机启动一个名为NetworkManager-wait-online服务，命令为： systemctl enable NetworkManager-wait-online.service</li> <li>查看/etc/sysconfig/network-scripts下，将其余无关的网卡位置文件全删掉，避免不必要的影响，即只留一个以 ifcfg开头的文件</li></ol> <p>配置systemd服务文件：vi /usr/lib/systemd/system/kube-proxy.service</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[Unit]
Description=Kubernetes Kube-proxy Server
Documentation=https://github.com/GoogleCloudPlatform/kubernetes
After=network.service
Requires=network.service
[Service]
EnvironmentFile=/etc/kubernetes/proxy
ExecStart=/usr/bin/kube-proxy $KUBE_PROXY_ARGS
Restart=on-failure
LimitNOFILE=65536
KillMode=process
[Install]
WantedBy=multi-user.target
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>配置文件：vi /etc/kubernetes/proxy</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>KUBE_PROXY_ARGS=&quot;--master=http://192.168.100.10:8080 --hostname-override=192.168.126.141 --logtostderr=true --log-dir=/var/log/kubernetes --v=2&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="启动-2"><a href="#启动-2" class="header-anchor">#</a> 启动</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl daemon-reload
systemctl enable kubelet
systemctl start kubelet
systemctl status kubelet
systemctl enable kube-proxy
systemctl start kube-proxy
systemctl status kube-proxy
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="node2安装"><a href="#node2安装" class="header-anchor">#</a> Node2安装</h3> <p>请参考Node1安装，注意修改IP</p> <h3 id="健康检查与示例测试"><a href="#健康检查与示例测试" class="header-anchor">#</a> 健康检查与示例测试</h3> <ul><li>查看集群状态</li></ul> <p><img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424151.png" alt="360截图17001020106131136"></p> <ul><li><p>查看master集群组件状态</p> <p><img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424152.png" alt="360截图1790010395136122"></p></li> <li><p>nginx-rc.yaml</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: ReplicationController
metadata:
 name: nginx
spec:
 replicas: 3
 selector:
  app: nginx
 template:
  metadata:
   labels:
    app: nginx
  spec:
   containers:
   - name: nginx
     image: nginx
     ports:
     - containerPort: 80     
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>kubectl create -f nginx-rc.yaml</p></li> <li><p>nginx-svc.yaml</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: Service
metadata:
 name: nginx
spec:
 type: NodePort
 ports:
  - port: 80
    nodePort: 30000
 selector:
   app: nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>kubectl create -f nginx-svc.yaml</p></li> <li><p>查看pod</p> <p><img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424153.png" alt="360截图17290512172129"></p></li> <li><p>查看具体pod详情</p></li> <li><p><img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424154.png" alt="360截图182005058010888"></p></li></ul> <h2 id="kubernetes核心技术"><a href="#kubernetes核心技术" class="header-anchor">#</a> Kubernetes核心技术</h2> <h3 id="pod详解"><a href="#pod详解" class="header-anchor">#</a> Pod详解</h3> <p>Pod是Kubernetes的最重要概念，每一个Pod都有一个特殊的被称为”根容器“的Pause容器。Pause容器对应的镜 像属于Kubernetes平台的一部分，除了Pause容器，每个Pod还包含一个或多个紧密相关的用户业务容器。</p> <p><img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424155.png" alt="image-20210122221014535"></p> <p><img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424156.png" alt="image-20210122221048772"></p> <ul><li><p>Pod vs 应用</p> <p>每个Pod都是应用的一个实例，有专用的IP</p></li> <li><p>Pod vs 容器</p> <p>一个Pod可以有多个容器，彼此间共享网络和存储资源，每个Pod 中有一个Pause容器保存所有的容器状态，
通过管理pause容器，达到管理pod中所有容器的效果</p></li> <li><p>Pod vs 节点</p> <p>同一个Pod中的容器总会被调度到相同Node节点，不同节点间Pod的通信基于虚拟二层网络技术实现</p></li> <li><p>Pod vs Pod</p> <p>普通的Pod和静态Pod</p></li></ul> <h4 id="pod的定义"><a href="#pod的定义" class="header-anchor">#</a> Pod的定义</h4> <p>下面是yaml文件定义的Pod的完整内容</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1            //版本 
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod                 //类型，pod 
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>                 //元数据 
  <span class="token key atrule">name</span><span class="token punctuation">:</span> string            //元数据，pod的名字 
  <span class="token key atrule">namespace</span><span class="token punctuation">:</span> string       //元数据，pod的命名空间   
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>                 //元数据，标签列表 
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> string        //元数据，标签的名字 
  <span class="token key atrule">annotations</span><span class="token punctuation">:</span>            //元数据<span class="token punctuation">,</span>自定义注解列表     
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> string        //元数据<span class="token punctuation">,</span>自定义注解名字 
<span class="token key atrule">spec</span><span class="token punctuation">:</span>                     //pod中容器的详细定义
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>             //pod中的容器列表，可以有多个容器 
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> string          //容器的名称 
    <span class="token key atrule">image</span><span class="token punctuation">:</span> string         //容器中的镜像 
    <span class="token key atrule">imagesPullPolicy</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Always<span class="token punctuation">|</span>Never<span class="token punctuation">|</span>IfNotPresent<span class="token punctuation">]</span>//获取镜像的策略，默认值为Always，每次都尝试重新下 载镜像
    <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>string<span class="token punctuation">]</span>     //容器的启动命令列表（不配置的话使用镜像内部的命令） 
    <span class="token key atrule">args</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>string<span class="token punctuation">]</span>        //启动参数列表 
    <span class="token key atrule">workingDir</span><span class="token punctuation">:</span> string    //容器的工作目录 
    <span class="token key atrule">volumeMounts</span><span class="token punctuation">:</span>         //挂载到到容器内部的存储卷设置 
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> string 
      <span class="token key atrule">mountPath</span><span class="token punctuation">:</span> string   //存储卷在容器内部Mount的绝对路径 
      <span class="token key atrule">readOnly</span><span class="token punctuation">:</span> boolean   //默认值为读写
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>                //容器需要暴露的端口号列表 
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> string 
      <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> int  //容器要暴露的 
      <span class="token key atrule">hostPort</span><span class="token punctuation">:</span> int     //容器所在主机监听的端口（容器暴露端口映射到宿主机的端口，设置hostPort时同一 台宿主机将不能再启动该容器的第2份副本） 
      <span class="token key atrule">protocol</span><span class="token punctuation">:</span> string    //TCP和UDP，默认值为TCP 
    <span class="token key atrule">env</span><span class="token punctuation">:</span>                  //容器运行前要设置的环境列表 
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> string 
      <span class="token key atrule">value</span><span class="token punctuation">:</span> string 
    <span class="token key atrule">resources</span><span class="token punctuation">:</span>             
      <span class="token key atrule">limits</span><span class="token punctuation">:</span>             //资源限制，容器的最大可用资源数量 
        <span class="token key atrule">cpu</span><span class="token punctuation">:</span> Srting 
        <span class="token key atrule">memory</span><span class="token punctuation">:</span> string 
      <span class="token key atrule">requeste</span><span class="token punctuation">:</span>           //资源限制，容器启动的初始可用资源数量 
        <span class="token key atrule">cpu</span><span class="token punctuation">:</span> string 
        <span class="token key atrule">memory</span><span class="token punctuation">:</span> string 
    <span class="token key atrule">livenessProbe</span><span class="token punctuation">:</span>         //pod内容器健康检查的设置 
      <span class="token key atrule">exec</span><span class="token punctuation">:</span> 
        <span class="token key atrule">command</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>string<span class="token punctuation">]</span>  //exec方式需要指定的命令或脚本 
      <span class="token key atrule">httpGet</span><span class="token punctuation">:</span>             //通过httpget检查健康 
        <span class="token key atrule">path</span><span class="token punctuation">:</span> string 
        <span class="token key atrule">port</span><span class="token punctuation">:</span> number 
        <span class="token key atrule">host</span><span class="token punctuation">:</span> string 
        <span class="token key atrule">scheme</span><span class="token punctuation">:</span> Srtring 
        <span class="token key atrule">httpHeaders</span><span class="token punctuation">:</span> 
        <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Stirng 
          <span class="token key atrule">value</span><span class="token punctuation">:</span> string 
      <span class="token key atrule">tcpSocket</span><span class="token punctuation">:</span>           //通过tcpSocket检查健康 
        <span class="token key atrule">port</span><span class="token punctuation">:</span> number 
      <span class="token key atrule">initialDelaySeconds</span><span class="token punctuation">:</span> 0//首次检查时间 
      <span class="token key atrule">timeoutSeconds</span><span class="token punctuation">:</span> 0     //检查超时时间 
      <span class="token key atrule">periodSeconds</span><span class="token punctuation">:</span> 0      //检查间隔时间 
      <span class="token key atrule">successThreshold</span><span class="token punctuation">:</span> <span class="token number">0</span> 
      <span class="token key atrule">failureThreshold</span><span class="token punctuation">:</span> <span class="token number">0</span> 
      <span class="token key atrule">securityContext</span><span class="token punctuation">:</span>      //安全配置 
        <span class="token key atrule">privileged</span><span class="token punctuation">:</span> falae
    <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>Always<span class="token punctuation">|</span>Never<span class="token punctuation">|</span>OnFailure<span class="token punctuation">]</span>//重启策略，默认值为Always 
    <span class="token key atrule">nodeSelector</span><span class="token punctuation">:</span> object    //节点选择，表示将该Pod调度到包含这些label的Node上，以key<span class="token punctuation">:</span>value格式指定           	
    <span class="token key atrule">imagePullSecrets</span><span class="token punctuation">:</span> 
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> string
    <span class="token key atrule">hostNetwork</span><span class="token punctuation">:</span> false      //是否使用主机网络模式，弃用Docker网桥，默认否
  <span class="token key atrule">volumes</span><span class="token punctuation">:</span>                  //在该pod上定义共享存储卷列表 
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> string 
    <span class="token key atrule">emptyDir</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>            //是一种与Pod同生命周期的存储卷，是一个临时目录，内容为空     
    <span class="token key atrule">hostPath</span><span class="token punctuation">:</span>               //Pod所在主机上的目录，将被用于容器中mount的目录 
      <span class="token key atrule">path</span><span class="token punctuation">:</span> string 
    <span class="token key atrule">secret</span><span class="token punctuation">:</span>                 //类型为secret的存储卷 
      <span class="token key atrule">secretName</span><span class="token punctuation">:</span> string 
      <span class="token key atrule">item</span><span class="token punctuation">:</span> 
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> string 
        <span class="token key atrule">path</span><span class="token punctuation">:</span> string 
    <span class="token key atrule">configMap</span><span class="token punctuation">:</span>             //类型为configMap的存储卷 
      <span class="token key atrule">name</span><span class="token punctuation">:</span> string 
      <span class="token key atrule">items</span><span class="token punctuation">:</span> 
      <span class="token punctuation">-</span> <span class="token key atrule">key</span><span class="token punctuation">:</span> string 
        <span class="token key atrule">path</span><span class="token punctuation">:</span> string 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br></div></div><h4 id="_3-1-2-pod的基本用法"><a href="#_3-1-2-pod的基本用法" class="header-anchor">#</a> 3.1.2 Pod的基本用法</h4> <p>在kubernetes中对运行容器的要求为：容器的主程序需要一直在前台运行，而不是后台运行。应用需要改造成前台运行的方式。如果我们创建的Docker镜像的启动命令是后台执行程序，则在kubelet创建包含这个容器的pod之后运行完该命令，即认为Pod已经结束，将立刻销毁该Pod。如果为该Pod定义了RC，则创建、销毁会陷入一个无限循环的过程中。</p> <p>Pod可以由1个或多个容器组合而成。</p> <ul><li><p>由一个容器组成的Pod示例</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token comment"># 一个容器组成的Pod</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> mytomcat
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> mytomcat
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> mytomcat
    <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8000</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div></li> <li><p>由两个为紧耦合的容器组成的Pod示例</p> <div class="language-yml line-numbers-mode"><pre class="language-yml"><code><span class="token comment">#两个紧密耦合的容器</span>
<span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> v1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> Pod
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> myweb
  <span class="token key atrule">labels</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat<span class="token punctuation">-</span>redis
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">containers</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> tomcat
    <span class="token key atrule">image</span><span class="token punctuation">:</span> tomcat
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">8080</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">image</span><span class="token punctuation">:</span> redis
    <span class="token key atrule">ports</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">containerPort</span><span class="token punctuation">:</span> <span class="token number">6379</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li> <li><p>创建</p> <p><code>kubectl create -f xxx.yaml</code></p></li> <li><p>查看</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>kubectl get pod/po <span class="token operator">&lt;</span>Pod_name<span class="token operator">&gt;</span>
kubectl get pod/po <span class="token operator">&lt;</span>Pod_name<span class="token operator">&gt;</span> <span class="token parameter variable">-o</span> wide
kubectl describe pod/po <span class="token operator">&lt;</span>Pod_name<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>删除</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>kubectl delete <span class="token parameter variable">-f</span> pod pod_name.yaml
kubectl delete pod --all/<span class="token punctuation">[</span>pod_name<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div></li></ul> <h4 id="_3-1-3-pod的分类"><a href="#_3-1-3-pod的分类" class="header-anchor">#</a> 3.1.3 Pod的分类</h4> <p>Pod有两种类型</p> <ul><li><p>普通Pod</p> <p>普通Pod一旦被创建，就会被放入到etcd中存储，随后会被Kubernetes Master调度到某个具体的Node上并 进行绑定，随后该Pod对应的Node上的kubelet进程实例化成一组相关的Docker容器并启动起来。在默认情 况下，当Pod里某个容器停止时，Kubernetes会自动检测到这个问题并且重新启动这个Pod里某所有容器， 如果Pod所在的Node宕机，则会将这个Node上的所有Pod重新调度到其它节点上。</p></li> <li><p>静态Pod</p> <p>静态Pod是由kubelet进行管理的仅存在于特定Node上的Pod,它们不能通过 API Server进行管理，无法与 ReplicationController、Deployment或DaemonSet进行关联，并且kubelet也无法对它们进行健康检查。</p></li></ul> <h4 id="pod生命周期和重启策略"><a href="#pod生命周期和重启策略" class="header-anchor">#</a> Pod生命周期和重启策略</h4> <ul><li><p>Pod的状态</p> <table><thead><tr><th style="text-align:left;">状态值</th> <th>说明</th></tr></thead> <tbody><tr><td style="text-align:left;">Pending</td> <td>API Server已经创建了该Pod,但Pod中的一个或多个容器的镜像还没有创建，包括镜像下载过程</td></tr> <tr><td style="text-align:left;">Running</td> <td>Pod内所有容器已创建，且至少一个容器处于运行状态、正在启动状态或正在重启状态</td></tr> <tr><td style="text-align:left;">Completed</td> <td>Pod内所有容器均成功执行退出，且不会再重启</td></tr> <tr><td style="text-align:left;">Failed</td> <td>Pod内所有容器均已退出，但至少一个容器退出失败</td></tr> <tr><td style="text-align:left;">Unknown</td> <td>由于某种原因无法获取Pod状态，例如网络通信不畅</td></tr></tbody></table></li> <li><p>Pod重启策略</p> <p>Pod的重启策略包括Always、OnFailure和Never，默认值是Always</p> <table><thead><tr><th>重启策略</th> <th>说明</th></tr></thead> <tbody><tr><td>Always</td> <td>当容器失效时，由kubelet自动重启该容器</td></tr> <tr><td>OnFailure</td> <td>当容器终止运行且退出码不为0时，由kubelet自动重启该容器</td></tr> <tr><td>Never</td> <td>不论容器运行状态如何，kubelet都不会重启该容器</td></tr></tbody></table></li></ul> <p>常见状态转换</p> <table><thead><tr><th>Pod包含的容器数</th> <th>Pod当前的状态</th> <th>发生事件</th> <th>Pod的结果状态</th> <th></th> <th></th></tr></thead> <tbody><tr><td></td> <td></td> <td></td> <td>RestartPolicy=Always</td> <td>RestartPolicy=OnFailure</td> <td>RestartPolicy=Never</td></tr> <tr><td>包含一个容器</td> <td>Running</td> <td>容器成功退出</td> <td>Running</td> <td>Succeeded</td> <td>Succeeded</td></tr> <tr><td>包含一个容器</td> <td>Running</td> <td>容器失败退出</td> <td>Running</td> <td>Running</td> <td>Failure</td></tr> <tr><td>包含两个容器</td> <td>Running</td> <td>1个容器失败退出</td> <td>Running</td> <td>Running</td> <td>Running</td></tr> <tr><td>包含两个容器</td> <td>Running</td> <td>容器被OOM杀掉</td> <td>Running</td> <td>Running</td> <td>Failure</td></tr></tbody></table> <h4 id="pod资源配置"><a href="#pod资源配置" class="header-anchor">#</a> Pod资源配置</h4> <p>每个Pod都可以对其能使用的服务器上的计算资源设置限额，Kubernetes中可以设置限额的计算资源有CPU与Memory两种，其中CPU的资源单位为CPU数量,是一个绝对值而非相对值。Memory配额也是一个绝对值，它的单位是内存字节数。</p> <p>Kubernetes里，一个计算资源进行配额限定需要设定以下两个参数：</p> <ol><li>Requests 该资源最小申请数量，系统必须满足要求</li> <li>Limits 该资源最大允许使用的量，不能突破，当容器试图使用超过这个量的资源时，可能会被Kubernetes Kill并重启</li></ol> <div class="language- line-numbers-mode"><pre class="language-text"><code>sepc
  containers:
  - name: db
	image: mysql
    resources:
      requests:
        memory: &quot;64Mi&quot;
        cpu: &quot;250m&quot;
      limits:
        memory: &quot;128Mi&quot;
        cpu: &quot;500m&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>上述代码表明MySQL容器申请最少0.25个CPU以及64MiB内存，在运行过程中容器所能使用的资源配额为0.5个 CPU以及128MiB内存。</p> <h3 id="label详解"><a href="#label详解" class="header-anchor">#</a> Label详解</h3> <p>Label是Kubernetes系统中另一个核心概念。一个Label是一个key=value的键值对，其中key与value由用户自己指定。Label可以附加到各种资源对象上，如Node、Pod、Service、RC，一个资源对象可以定义任意数量的Label， 同一个Label也可以被添加到任意数量的资源对象上，Label通常在资源对象定义时确定，也可以在对象创建后动态添加或删除。</p> <p>Label的最常见的用法是使用metadata.labels字段，来为对象添加Label，通过spec.selector来引用对象</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: ReplicationController
metadata:
  name: nginx
spec:
  replicas: 3
  selector:
    app: nginx
  template:
	metadata:
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx
        ports:
        - containerPort: 80
-------------------------------------
apiVersion: v1
kind: Service
metadata:
  name: nginx
spec:
  type: NodePort
  ports:
    - port: 80
      nodePort: 3333
  selector:
    app: nginx
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p>Label附加到Kubernetes集群中的各种资源对象上，目的就是对这些资源对象进行分组管理，而分组管理的核心就是Label Selector。Label与Label Selector都是不能单独定义，必须附加在一些资源对象的定义文件上，一般附加在RC和Service的资源定义文件中。</p> <h3 id="replication-controller详解"><a href="#replication-controller详解" class="header-anchor">#</a> Replication Controller详解</h3> <p>Replication Controller(RC)是Kubernetes系统中核心概念之一，当我们定义了一个RC并提交到Kubernetes集群中以后，Master节点上的Controller Manager组件就得到通知，定期检查系统中存活的Pod,并确保目标Pod实例的数量刚好等于RC的预期值，如果有过多或过少的Pod运行，系统就会停掉或创建一些Pod.此外我们也可以通过修改RC的副本数量，来实现Pod的动态缩放功能。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl scale rc nginx --replicas=5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>由于Replication Controller与Kubernetes代码中的模块Replication Controller同名，所以在Kubernetes v1.2时， 它就升级成了另外一个新的概念Replica Sets,官方解释为下一代的RC，它与RC区别是：Replica Sets支援基于集合的 Label selector,而RC只支持基于等式的Label Selector。我们很少单独使用Replica Set,它主要被Deployment这个更高层面的资源对象所使用，从而形成一整套Pod创建、删除、更新的编排机制。最好不要越过RC直接创建Pod， 因为Replication Controller会通过RC管理Pod副本，实现自动创建、补足、替换、删除Pod副本，这样就能提高应用的容灾能力，减少由于节点崩溃等意外状况造成的损失。即使应用程序只有一个Pod副本，也强烈建议使用RC来定义Pod。</p> <h3 id="replica-set详解"><a href="#replica-set详解" class="header-anchor">#</a> Replica Set详解</h3> <p>Replica Set 跟 Replication Controller 没有本质的不同，只是名字不一样，并且 ReplicaSet 支持集合式的selector（Replication Controller 仅支持等式）。Kubernetes官方强烈建议避免直接使用Replica Set，而应该通过 Deployment来创建RS和Pod。由于Replica Set是Replication Controller的代替物，因此用法基本相同，唯一的区别在于ReplicaSet支持集合式的selector。</p> <h3 id="deployment详解"><a href="#deployment详解" class="header-anchor">#</a> Deployment详解</h3> <p>Deployment是Kubenetes v1.2引入的新概念，引入的目的是为了更好的解决Pod的编排问题，Deployment内部使用了Replica Set来实现。Deployment的定义与Replica Set的定义很类似，除了API声明与Kind类型有所区别：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: extensions/v1beta1
kind: Deployment
metadata:
  name: frontend
spec:
  replicas: 1
  selector:
    matchLabels:
      tier: frontend
    matchExpressions:
      - {key: tier, operator: In, values: [frontend]}
  template:
    metadata:
      labels:
        app: app-demo
        tier: frontend
    spec:
      containers:
      - name: tomcat-demo
        image: tomcat
        ports:
        - containerPort: 8080
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h3 id="horizontal-pod-autoscaler"><a href="#horizontal-pod-autoscaler" class="header-anchor">#</a> Horizontal Pod Autoscaler</h3> <p>Horizontal Pod Autoscal(Pod横向扩容 简称HPA)与RC、Deployment一样，也属于一种Kubernetes资源对象。通过追踪分析RC控制的所有目标Pod的负载变化情况，来确定是否需要针对性地调整目标Pod的副本数，这是HPA的实现原理。</p> <p>Kubernetes对Pod扩容与缩容提供了手动和自动两种模式，手动模式通过kubectl scale命令对一个Deployment/RC进行Pod副本数量的设置。自动模式则需要用户根据某个性能指标或者自定义业务指标，并指定Pod副本数量的范围，系统将自动在这个范围内根据性能指标的变化进行调整。</p> <ul><li><p>手动扩容和缩容</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl scale deployment frontend --replicas 1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li> <li><p>自动扩容和缩容</p> <p>HPA控制器基本Master的kube-controller-manager服务启动参数 --horizontal-pod-autoscaler-sync-period 定义的时长(默认值为30s),周期性地监测Pod的CPU使用率，并在满足条件时对RC或Deployment中的Pod副本数量进行调整，以符合用户定义的平均Pod CPU使用率。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: apps/v1beta1
kind: Deployment
metadata:
  name: nginx-deployment
spec:
  replicas: 1
  template:
    metadata:
      name: nginx
      labels:
        app: nginx
    spec:
      containers:
      - name: nginx
        image: nginx
        resources:
          requests:
            cpu: 50m
        ports:
        - containerPort: 80
-------------------------------
apiVersion: v1
kind: Service
metadata:
 name: nginx-svc
spec:
 type: NodePort
 ports:
  - port: 80
 selector:
   app: nginx
-------------------------------
apiVersion: autoscaling/v1
kind: HorizontalPodAutoscaler
metadata:
  name: nginx-hpa
spec:
  scaleTargetRef:
    apiVersion: app/v1beta1
    kind: Deployment
    name: nginx-deployment
  minReplicas: 1
  maxReplicas: 10
  targetCPUUtilizationPercentage: 50

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div></li></ul> <h3 id="volume详解"><a href="#volume详解" class="header-anchor">#</a> Volume详解</h3> <p>Volume是Pod中能够被多个容器访问的共享目录。Kubernetes的Volume定义在Pod上，它被一个Pod中的多个容 器挂载到具体的文件目录下。Volume与Pod的生命周期相同，但与容器的生命周期不相关，当容器终止或重启 时，Volume中的数据也不会丢失。要使用volume，pod需要指定volume的类型和内容（ spec.volumes 字段）， 和映射到容器的位置（ spec.containers.volumeMounts 字段）。 Kubernetes支持多种类型的Volume,包括： emptyDir、hostPath、gcePersistentDisk、awsElasticBlockStore、nfs、iscsi、flocker、glusterfs、rbd、 cephfs、gitRepo、secret、persistentVolumeClaim、downwardAPI、azureFileVolume、azureDisk、 vsphereVolume、Quobyte、PortworxVolume、ScaleIO。</p> <ul><li><p>emptyDir</p> <p>EmptyDir类型的volume创建于pod被调度到某个宿主机上的时候，而同一个pod内的容器都能读写EmptyDir中的同一个文件。一旦这个pod离开了这个宿主机，EmptyDir中的数据就会被永久删除。所以目前EmptyDir 类型的volume主要用作临时空间，比如Web服务器写日志或者tmp文件需要的临时目录。</p> <p>yaml示例如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: Pod
metadata:
  name: test-pd
spec:
  containers:
  - image: docker.io/nazarpc/webserver
    name: test-container
    volumeMounts:
    - mountPath: /cache
      name: cache-volume
  volumes:
    - name: cache-volume
    emptyDir: {}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div></li> <li><p>hostPath</p> <p>HostPath属性的volume使得对应的容器能够访问当前宿主机上的指定目录。例如，需要运行一个访问 Docker系统目录的容器，那么就使用/var/lib/docker目录作为一个HostDir类型的volume；或者要在一个容器内部运行CAdvisor，那么就使用/dev/cgroups目录作为一个HostDir类型的volume。一旦这个pod离开了 这个宿主机，HostDir中的数据虽然不会被永久删除，但数据也不会随pod迁移到其他宿主机上。因此，需要注意的是，由于各个宿主机上的文件系统结构和内容并不一定完全相同，所以相同pod的HostDir可能会在不同的宿主机上表现出不同的行为。</p> <p>yaml示例如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: Pod
metadata:
  name: test-pd
spec:
  containers:
  - image: docker.io/nazarpc/webserver
    name: test-container
    # 指定在容器中挂接路径
    volumeMounts:
    - mountPath: /test-pd
      name: test-volume
  # 指定所提供的存储卷
  volumes:
  - name: test-volume
    # 宿主机上的目录
    hostPath:
      # directory location on host
      path: /data
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div></li> <li><p>nfs</p> <p>NFS类型的volume。允许一块现有的网络硬盘在同一个pod内的容器间共享。</p> <p>yaml示例如下：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: apps/v1 # for versions before 1.9.0 use apps/v1beta2
kind: Deployment
metadata:
  name: redis
spec:
  selector:
    matchLabels:
      app: redis
  revisionHistoryLimit: 2
  template:
    metadata:
      labels:
        app: redis
    spec:
      containers:
      # 应用的镜像
      - image: redis
        name: redis
        imagePullPolicy: IfNotPresent
        # 应用的内部端口
        ports:
        - containerPort: 6379
          name: redis6379
        env:
        - name: ALLOW_EMPTY_PASSWORD
          value: &quot;yes&quot;
        - name: REDIS_PASSWORD
          value: &quot;redis&quot;
          # 持久化挂接位置，在docker中
        volumeMounts:
        - name: redis-persistent-storage
          mountPath: /data
      volumes:
      # 宿主机上的目录
      - name: redis-persistent-storage
        nfs:
          path: /k8s-nfs/redis/data
          server: 192.168.126.112
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div></li></ul> <h3 id="namespace详解"><a href="#namespace详解" class="header-anchor">#</a> Namespace详解</h3> <p>Namespace在很多情况下用于实现多用户的资源隔离，通过将集群内部的资源对象分配到不同的Namespace中， 形成逻辑上的分组，便于不同的分组在共享使用整个集群的资源同时还能被分别管理。Kubernetes集群在启动后，会创建一个名为&quot;default&quot;的Namespace，如果不特别指明Namespace,则用户创建的Pod，RC，Service都将被系统创建到这个默认的名为default的Namespace中。</p> <ul><li><p>Namespace创建</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: Namespace
metadata:
  name: development
---------------------
apiVersion: v1
kind: Pod
metadata:
  name: busybox
  namespace: development
spec:
  containers:
  - image: busybox
    command:
      - sleep
      - &quot;3600&quot;
    name: busybox
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div></li> <li><p>Namespace查看</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl get pods --namespace=development
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></li></ul> <h3 id="service-详解"><a href="#service-详解" class="header-anchor">#</a> Service 详解</h3> <p>Service是Kubernetes最核心概念，通过创建Service,可以为一组具有相同功能的容器应用提供一个统一的入口地址，并且将请求负载分发到后端的各个容器应用上。</p> <h4 id="service的定义"><a href="#service的定义" class="header-anchor">#</a> Service的定义</h4> <p>yaml格式的Service定义文件：</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: Service
matadata:
  name: string
  namespace: string
  labels:
  - name: string
  annotations:
  - name: string
spec:
  selector: []
  type: string
  clusterIP: string
  sessionAffinity: string
  ports:
  - name: string
    protocol: string
    port: int
    targetPort: int
    nodePort: int
  status:
    loadBalancer:
      ingress:
        ip: string
        hostname: string
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><table><thead><tr><th>属性名称</th> <th>取值类型</th> <th>是否必选</th> <th>取值说明</th></tr></thead> <tbody><tr><td>version</td> <td>string</td> <td>Required</td> <td>v1</td></tr> <tr><td>kind</td> <td>string</td> <td>Required</td> <td>Service</td></tr> <tr><td>metadata</td> <td>object</td> <td>Required</td> <td>元数据</td></tr> <tr><td>metadata.name</td> <td>string</td> <td>Required</td> <td>Service名称</td></tr> <tr><td>metadata.namespace</td> <td>string</td> <td>Required</td> <td>命名空间，默认为default</td></tr> <tr><td>metadata.labels[]</td> <td>list</td> <td></td> <td>自定义标签属性列表</td></tr> <tr><td>metadata.annotation[]</td> <td>list</td> <td></td> <td>自定义注解属性列表</td></tr> <tr><td>spec</td> <td>object</td> <td>Required</td> <td>详细描述</td></tr> <tr><td>spec.selector[]</td> <td>list</td> <td>Required</td> <td>Label Selector配置，将选择具有指定 Label标签的Pod作为管理范围</td></tr> <tr><td>spec.type</td> <td>string</td> <td>Required</td> <td>Service的类型，指定Service的访问方 式，默认值为ClusterIP。取值范围如 下：ClusterIP: 虚拟服务的IP，用于k8s 集群内部的pod访问，在Node上kubeproxy通过设置的Iptables规则进行转 发。NodePort：使用宿主机的端口，使用能够访问各Node的外部客户端通过 Node的IP地址和端口就能访问服务。 LoadBalancer: 使用外接负载均衡器完成到服务的负载分发，需要在 spec.status.loadBalancer字段指定外部 负载均衡器的IP地址，并同时定义 nodePort和clusterIP，用于公有云环境。</td></tr> <tr><td>spec.clusterIP</td> <td>string</td> <td></td> <td>虚拟服务的IP地址，当type=clusterIP 时，如果不指定，则系统进行自动分配。也可以手工指定。当 type=LoadBalancer时，则需要指定。</td></tr> <tr><td>spec.sessionAffinity</td> <td>string</td> <td></td> <td>是否支持Session，可选值为ClientIP， 表示将同一个源IP地址的客户端访问请求 都转发到同一个后端Pod。默认值为空。</td></tr> <tr><td>spec.ports[]</td> <td>list</td> <td></td> <td>Service需要暴露的端口列表</td></tr> <tr><td>spec.ports[].name</td> <td>string</td> <td></td> <td>端口名称</td></tr> <tr><td>spec.ports[].protocol</td> <td>string</td> <td></td> <td>端口协议，支持TCP和UDP，默认值为 TCP</td></tr> <tr><td>spec.ports[].port</td> <td>int</td> <td></td> <td>服务监听的端口号</td></tr> <tr><td>spec.ports[].targetPort</td> <td>int</td> <td></td> <td>需要转发到后端Pod的端口号</td></tr> <tr><td>spec.ports[].nodePort</td> <td>int</td> <td></td> <td>当spec.type=NodePort时，指定映射到物理机的端口号</td></tr> <tr><td>status</td> <td>object</td> <td></td> <td>当spec.type=LoadBalancer时，设置外 部负载均衡器的地址，用于公有云环境</td></tr> <tr><td>status.loadBalancer</td> <td>object</td> <td></td> <td>外部负载均衡器</td></tr> <tr><td>status.loadBalancer.ingress</td> <td>object</td> <td></td> <td>外部负载均衡器</td></tr> <tr><td>status.loadBalancer.ingress.ip</td> <td>string</td> <td></td> <td>外部负载均衡器的IP地址</td></tr> <tr><td>status.loadBalancer.ingress.hostname</td> <td>string</td> <td></td> <td>外部负载均衡器的主机名</td></tr></tbody></table> <h4 id="service的基本用法"><a href="#service的基本用法" class="header-anchor">#</a> Service的基本用法</h4> <p>在某些特殊环境中，应用系统需要将一个外部数据库作为后端服务进行连接，或将另一个集群或Namespace中的服务作为服务的后端，这时可以通过创建一个无Label Selector的Service来实现。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: Service
metadata:
  name: my-service
spec:
  ports:
  - protocol: TCP
    port: 80
    targetPort: 80
-------------------
apiVersion: v1
kind: Endpoints
metadata:
  name: my-service
subsets:
- addresses:
  - IP: 10.254.74.3
  ports:
  - port: 8080
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>我们可以通过kubectl get pods -l app=mywebapp -o yaml | grep podIP来获取Pod的IP地址和端口号来访问 Tomcat服务，但是直接通过Pod的IP地址和端口访问应用服务是不可靠的，因为当Pod所在的Node发生故障时， Pod将被kubernetes重新调度到另一台Node，Pod的地址会发生改变。我们可以通过配置文件来定义Service，再通过kubectl create来创建，这样可以通过Service地址来访问后端的Pod。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: Service
metadata:
  name: mywebAppService
spec:
  ports:
  - port: 8081
    targetPort: 8080
  selector:
    app: mywebapp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="多端口service"><a href="#多端口service" class="header-anchor">#</a> 多端口Service</h5> <p>有时一个容器应用也可能需要提供多个端口的服务，那么在Service的定义中也可以相应地设置为将多个端口对应到多个应用服务。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: Service
metadata:
  name: mywebAppService
spec:
  ports:
  - port: 8080
    targetPort: 8080
    name: web
  - port: 8005
    targetPort: 8005
    name: management
  selector:
    app: mywebapp
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="外部服务service"><a href="#外部服务service" class="header-anchor">#</a> 外部服务Service</h5> <p>在某些特殊环境中，应用系统需要将一个外部数据库作为后端服务进行连接，或将另一个集群或Namespace中的 服务作为服务的后端，这时可以通过创建一个无Label Selector的Service来实现。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: Service
metadata:
  name: my-service
spec:
  ports:
  - protocol: TCP
    port: 80
    targetPort: 80
--------------------------
apiVersion: v1
kind: Endpoints
metadata:
  name: my-service
subsets:
  - addresses:
    - IP: 10.254.74.3
    ports:
    - port: 8080
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="总结"><a href="#总结" class="header-anchor">#</a> 总结</h2> <h3 id="k8s架构和组件"><a href="#k8s架构和组件" class="header-anchor">#</a> K8S架构和组件</h3> <p><img src="https://jsd.cdn.zzko.cn/gh/micolor/images/note/202401121424157.png" alt="360截图17290509342963"></p> <h4 id="master-2"><a href="#master-2" class="header-anchor">#</a> Master</h4> <ul><li><p>Kubernetes API Server</p> <p>作为Kubernetes系统的入口，其封装了核心对象的增删改查操作，以RESTful API接口方式提供给外部客户和内部组件调用。维护的REST对象持久化到Etcd中存储。</p></li> <li><p>Kubernetes Scheduler
为新建立的Pod进行节点(node)选择(即分配机器)，负责集群的资源调度。组件抽离，可以方便替换成其他调度器。</p></li> <li><p>Kubernetes Controller</p> <p>负责执行各种控制器，目前已经提供了很多控制器来保证Kubernetes的正常运行。</p></li> <li><p>Replication Controller</p> <p>管理维护Replication Controller，关联Replication Controller和Pod，保证Replication Controller定义的副本数量与实际运行Pod数量一致。</p></li></ul> <h4 id="node-2"><a href="#node-2" class="header-anchor">#</a> Node</h4> <ul><li><p>Kubelet</p> <p>负责管控容器，Kubelet会从Kubernetes API Server接收Pod的创建请求，启动和停止容器，监控容器运行状态并汇报给Kubernetes API Server。</p></li> <li><p>Kubernetes Proxy</p> <p>负责为Pod创建代理服务，Kubernetes Proxy会从Kubernetes API Server获取所有的Service信息，并根据Service的信息创建代理服务，实现Service到Pod的请求路由和转发，从而实现Kubernetes层级的虚拟转发网络。</p></li> <li><p>Docker</p> <p>Node上需要运行容器服务</p></li></ul> <h3 id="k8s集群搭建常见问题"><a href="#k8s集群搭建常见问题" class="header-anchor">#</a> K8S集群搭建常见问题</h3> <h3 id="docker启动失败"><a href="#docker启动失败" class="header-anchor">#</a> docker启动失败</h3> <p>如果docker启动失败，请参考(vi /etc/sysconfig/selinux 把selinux后面的改为disabled，重启 一波 机器，再重启docker就可以了)</p> <h3 id="解决-kubectl-get-pods时no-resources-found问题"><a href="#解决-kubectl-get-pods时no-resources-found问题" class="header-anchor">#</a> 解决 kubectl get pods时No resources found问题</h3> <p>1、vim /etc/kubernetes/apiserver</p> <p>2、找到”KUBE_ADMISSION_CONTROL=&quot;- admission_control=NamespaceLifecycle,NamespaceExists,LimitRanger,SecurityContextDeny,ServiceAccount,ResourceQuota&quot;，去掉ServiceAccount，保存退出。</p> <p>3、systemctl restart kube-apiserver  重启此服务</p> <h3 id="pull-失败"><a href="#pull-失败" class="header-anchor">#</a> pull 失败</h3> <ul><li><p>解决方案1</p> <p>1、yum install <em>rhsm</em> -y</p> <p>2、docker pull registry.access.redhat.com/rhel7/pod-infrastructure:latest</p> <p>如果以上两步解决问题了，那么就不需要在执行下面操作</p> <p>3、docker search pod-infrastructure</p> <p>4、docker pull docker.io/tianyebj/pod-infrastructure</p> <p>5、docker tag tianyebj/pod-infrastructure 192.168.126.143:5000/pod-infrastructure</p> <p>6、docker push 192.168.126.143:5000/pod-infrastructure</p> <p>7、vi /etc/kubernetes/kubelet</p> <p>修改 KUBELET_POD_INFRA_CONTAINER=&quot;--pod-infra-container-image=192.168.126.143：5000/pod-infrastructure:latest&quot;</p> <p>8、重启服务</p> <p>systemctl restart kube-apiserver
systemctl restart kube-controller-manager
systemctl restart kube-scheduler
systemctl restart kubelet
systemctl restart kube-proxy</p></li> <li><p>解决方案2</p> <p>1、docker pull kubernetes/pause</p> <p>2、docker tag docker.io/kubernetes/pause:latest 192.168.126.143:5000/google_containers/pause-amd64.3.0</p> <p>3、docker push 192.168.126.143:5000/google_containers/pause-amd64.3.0</p> <p>4、vi /etc/kubernetes/kubelet配置为</p> <p>​	KUBELET_ARGS=&quot;--pod_infra_container_image=192.168.126.143:5000/google_containers/pause-amd64.3.0&quot;</p> <p>5、重启kubelet服务   systemctl restart kubelet</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>私有仓库搭建
docker pull registry
docker run -di --name=registry -p 5000:5000 registry
修改daemon.json {&quot;insecure-registries&quot;:[&quot;192.168.126.148:5000&quot;]}
重启docker服务 systemctl restart docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div></li></ul> <h3 id="解决内外可以访问外网无法访问"><a href="#解决内外可以访问外网无法访问" class="header-anchor">#</a> 解决内外可以访问外网无法访问</h3> <p><code>curl 服务地址</code></p> <p>由于k8s的的iptables导致的，设置转发</p> <p><code>iptables -P FORWARD ACCEPT</code></p> <h3 id="根据报错日志排查并解决集群中启动遇到的问题"><a href="#根据报错日志排查并解决集群中启动遇到的问题" class="header-anchor">#</a> 根据报错日志排查并解决集群中启动遇到的问题</h3> <p>如启动kubelet：systemctl start kubelet</p> <p>查看kubelet状态：systemctl status kubelet</p> <p>查看具体报错明细：</p> <p><code>journalctl -xefu kubelet</code> 查看systemd日志发现真正的错误原因或者查看日志文件 cat /var/messages | grep kubelet*，找到错误信息,根据具体报错信息解决。</p> <h3 id="the-connection-to-the-server-localhost-8080-was-refused-did-you-specify-the-right-host-or-port"><a href="#the-connection-to-the-server-localhost-8080-was-refused-did-you-specify-the-right-host-or-port" class="header-anchor">#</a> The connection to the server localhost:8080 was refused - did you specify the right host or port?</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>echo export KUBECONFIG=/etc/kubernetes/admin.conf &gt;&gt; ~/.bash_profile
source ~/.bash_profile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="pod状态一直pending"><a href="#pod状态一直pending" class="header-anchor">#</a> pod状态一直pending</h3> <ul><li>0/1 nodes are available: 1 node(s) had taints that the pod didn't tolerate.</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>允许master节点部署pod
kubectl taint nodes --all node-role.kubernetes.io/master-
如果不允许调度
kubectl taint nodes master1 node-role.kubernetes.io/master=:NoSchedule
污点可选参数
	  NoSchedule: 一定不能被调度
      PreferNoSchedule: 尽量不要调度
      NoExecute: 不仅不会调度, 还会驱逐Node上已有的Pod
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="unexpected-error-getting-claim-reference-selflink-was-empty-can-t-make-reference"><a href="#unexpected-error-getting-claim-reference-selflink-was-empty-can-t-make-reference" class="header-anchor">#</a> unexpected error getting claim reference: selfLink was empty, can't make reference</h3> <p>Current workaround is to edit /etc/kubernetes/manifests/kube-apiserver.yaml</p> <p>Under here:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>spec:
  containers:
  - command:
    - kube-apiserver
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>Add this line:
- --feature-gates=RemoveSelfLink=false</p> <p>The do this:</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl apply -f /etc/kubernetes/manifests/kube-apiserver.yaml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="常用命令"><a href="#常用命令" class="header-anchor">#</a> 常用命令</h2> <ul><li><p>获取当前命名空间下的容器</p> <p>kubectl get pods</p></li> <li><p>获取所有容器l列表</p> <p>kubectl get  all</p></li> <li><p>创建 容器</p> <p>kubectl create -f kubernate-pvc.yaml</p></li> <li><p>删除容器</p> <p>kubectl delete pods/test-pd  或者 kubectl delete -f rc-nginx.yaml</p></li> <li><p>查看指定pod跑在哪个node上</p> <p>kubectl get pod /test-pd -o wide</p></li> <li><p>查看容器日志</p> <p>Kubectl logs nginx-8586cf59-mwwtc</p></li> <li><p>进入容器终端命令</p> <p>kubectl exec -it nginx-8586cf59-mwwtc /bin/bash</p></li> <li><p>一个Pod里含有多个容器 用--container or -c 参数。</p> <p>例如:假如这里有个Pod名为my-pod,这个Pod有两个容器,分别名为main-app 和 helper-app,下面的命令将打开到main-app的shell的容器里。</p> <p>kubectl exec -it my-pod --container main-app -- /bin/bash</p></li> <li><p>容器详情列表</p> <p>kubectl <em>describe</em> pod/mysql- m8rbl</p></li> <li><p>查看容器状态</p> <p>kubectl get svc</p></li></ul> <h2 id="防火墙相关"><a href="#防火墙相关" class="header-anchor">#</a> 防火墙相关</h2> <div class="language- line-numbers-mode"><pre class="language-text"><code>#查看防火墙某个端口是否开放
firewall-cmd --query-port=3306/tcp
#开放防火墙端口3306
firewall-cmd --zone=public --add-port=3306/tcp --permanent
#查看防火墙状态
systemctl status firewalld
#关闭防火墙
systemctl stop firewalld
#打开防火墙
systemctl start firewalld
#开放一段端口
firewall-cmd --zone=public --add-port=40000-45000/tcp --permanent
#查看开放的端口列表
firewall-cmd --zone=public --list-ports
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="安装手册"><a href="#安装手册" class="header-anchor">#</a> 安装手册</h2> <h2 id="centos8上部署kubernetes"><a href="#centos8上部署kubernetes" class="header-anchor">#</a> Centos8上部署kubernetes</h2> <h3 id="查看系统版本"><a href="#查看系统版本" class="header-anchor">#</a> 查看系统版本</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@localhost]# cat /etc/centos-release
CentOS Linux release 8.1.1911 (Core)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="配置网络"><a href="#配置网络" class="header-anchor">#</a> 配置网络</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@localhost ~]# cat /etc/sysconfig/network-scripts/ifcfg-enp0s3
TYPE=Ethernet
PROXY_METHOD=none
BROWSER_ONLY=no
BOOTPROTO=static
DEFROUTE=yes
IPV4_FAILURE_FATAL=no
IPV6INIT=yes
IPV6_AUTOCONF=yes
IPV6_DEFROUTE=yes
IPV6_FAILURE_FATAL=no
IPV6_ADDR_GEN_MODE=stable-privacy
NAME=enp0s3
UUID=039303a5-c70d-4973-8c91-97eaa071c23d
DEVICE=enp0s3
ONBOOT=yes
IPADDR=192.168.122.21
NETMASK=255.255.255.0
GATEWAY=192.168.122.1
DNS1=223.5.5.5
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="添加阿里源"><a href="#添加阿里源" class="header-anchor">#</a> 添加阿里源</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@localhost ~]# rm -rfv /etc/yum.repos.d/*
[root@localhost ~]# curl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-8.repo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="配置主机名"><a href="#配置主机名" class="header-anchor">#</a> 配置主机名</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# cat /etc/hosts
127.0.0.1   localhost localhost.localdomain localhost4 localhost4.localdomain4
::1         localhost localhost.localdomain localhost6 localhost6.localdomain6
192.168.122.21 master01.paas.com master01
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>关闭swap，注释swap分区</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# swapoff -a
[root@master01 ~]# cat /etc/fstab

#
# /etc/fstab
# Created by anaconda on Tue Mar 31 22:44:34 2020
#
# Accessible filesystems, by reference, are maintained under '/dev/disk/'.
# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info.
#
# After editing this file, run 'systemctl daemon-reload' to update systemd
# units generated from this file.
#
/dev/mapper/cl-root     /                       xfs     defaults        0 0
UUID=5fecb240-379b-4331-ba04-f41338e81a6e /boot                   ext4    defaults        1 2
/dev/mapper/cl-home     /home                   xfs     defaults        0 0
#/dev/mapper/cl-swap     swap                    swap    defaults        0 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>配置内核参数，将桥接的IPv4流量传递到iptables的链</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# cat &gt; /etc/sysctl.d/k8s.conf &lt;&lt;EOF
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
EOF
sysctl --system
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="安装常用包"><a href="#安装常用包" class="header-anchor">#</a> 安装常用包</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# yum install vim bash-completion net-tools gcc -y
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="使用aliyun源安装docker-ce"><a href="#使用aliyun源安装docker-ce" class="header-anchor">#</a> 使用aliyun源安装docker-ce</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# yum install -y yum-utils device-mapper-persistent-data lvm2
[root@master01 ~]# yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
[root@master01 ~]# yum -y install docker-ce
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>添加aliyundocker仓库加速器</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# mkdir -p /etc/docker
[root@master01 ~]# tee /etc/docker/daemon.json &lt;&lt;-'EOF'
{
  &quot;registry-mirrors&quot;: [&quot;https://fl791z1h.mirror.aliyuncs.com&quot;]
  &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]
}
EOF
[root@master01 ~]# systemctl daemon-reload
[root@master01 ~]# systemctl restart docker
[root@master01 ~]# systemctl enable docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="安装kubectl、kubelet、kubeadm"><a href="#安装kubectl、kubelet、kubeadm" class="header-anchor">#</a> 安装kubectl、kubelet、kubeadm</h3> <h4 id="添加阿里kubernetes源"><a href="#添加阿里kubernetes源" class="header-anchor">#</a> 添加阿里kubernetes源</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
EOF
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# yum install kubectl kubelet kubeadm
[root@master01 ~]# systemctl enable kubelet
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="初始化k8s集群"><a href="#初始化k8s集群" class="header-anchor">#</a> 初始化k8s集群</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# kubeadm init --kubernetes-version=1.18.0  \
--apiserver-advertise-address=192.168.100.7   \
--image-repository registry.aliyuncs.com/google_containers  \
--service-cidr=10.10.0.0/16 --pod-network-cidr=10.122.0.0/16
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>POD的网段为: 10.122.0.0/16， api server地址就是master本机IP。</p> <p>这一步很关键，由于kubeadm 默认从官网k8s.grc.io下载所需镜像，国内无法访问，因此需要通过–image-repository指定阿里云镜像仓库地址。</p> <p>记录生成的最后部分内容，此内容需要在其它节点加入Kubernetes集群时执行。
根据提示创建kubectl</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# mkdir -p $HOME/.kube
[root@master01 ~]# sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
[root@master01 ~]# sudo chown $(id -u):$(id -g) $HOME/.kube/config
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h4 id="使kubectl可以自动补充"><a href="#使kubectl可以自动补充" class="header-anchor">#</a> 使kubectl可以自动补充</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# source &lt;(kubectl completion bash)
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>查看节点，pod</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# kubectl get node
NAME                STATUS     ROLES    AGE     VERSION
master01.paas.com   NotReady   master   2m29s   v1.18.0
[root@master01 ~]# kubectl get pod --all-namespaces
NAMESPACE     NAME                                        READY   STATUS    RESTARTS   AGE
kube-system   coredns-7ff77c879f-fsj9l                    0/1     Pending   0          2m12s
kube-system   coredns-7ff77c879f-q5ll2                    0/1     Pending   0          2m12s
kube-system   etcd-master01.paas.com                      1/1     Running   0          2m22s
kube-system   kube-apiserver-master01.paas.com            1/1     Running   0          2m22s
kube-system   kube-controller-manager-master01.paas.com   1/1     Running   0          2m22s
kube-system   kube-proxy-th472                            1/1     Running   0          2m12s
kube-system   kube-scheduler-master01.paas.com            1/1     Running   0          2m22s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>node节点为NotReady，因为corednspod没有启动，缺少网络pod</p> <h3 id="安装calico网络"><a href="#安装calico网络" class="header-anchor">#</a> 安装calico网络</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# kubectl apply -f https://docs.projectcalico.org/manifests/calico.yaml
configmap/calico-config created
customresourcedefinition.apiextensions.k8s.io/bgpconfigurations.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/bgppeers.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/blockaffinities.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/clusterinformations.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/felixconfigurations.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/globalnetworkpolicies.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/globalnetworksets.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/hostendpoints.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/ipamblocks.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/ipamconfigs.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/ipamhandles.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/ippools.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/networkpolicies.crd.projectcalico.org created
customresourcedefinition.apiextensions.k8s.io/networksets.crd.projectcalico.org created
clusterrole.rbac.authorization.k8s.io/calico-kube-controllers created
clusterrolebinding.rbac.authorization.k8s.io/calico-kube-controllers created
clusterrole.rbac.authorization.k8s.io/calico-node created
clusterrolebinding.rbac.authorization.k8s.io/calico-node created
daemonset.apps/calico-node created
serviceaccount/calico-node created
deployment.apps/calico-kube-controllers created
serviceaccount/calico-kube-controllers created
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>查看pod和node</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# kubectl get pod --all-namespaces
NAMESPACE     NAME                                        READY   STATUS    RESTARTS   AGE
kube-system   calico-kube-controllers-555fc8cc5c-k8rbk    1/1     Running   0          36s
kube-system   calico-node-5km27                           1/1     Running   0          36s
kube-system   coredns-7ff77c879f-fsj9l                    1/1     Running   0          5m22s
kube-system   coredns-7ff77c879f-q5ll2                    1/1     Running   0          5m22s
kube-system   etcd-master01.paas.com                      1/1     Running   0          5m32s
kube-system   kube-apiserver-master01.paas.com            1/1     Running   0          5m32s
kube-system   kube-controller-manager-master01.paas.com   1/1     Running   0          5m32s
kube-system   kube-proxy-th472                            1/1     Running   0          5m22s
kube-system   kube-scheduler-master01.paas.com            1/1     Running   0          5m32s
[root@master01 ~]# kubectl get node
NAME                STATUS   ROLES    AGE     VERSION
master01.paas.com   Ready    master   5m47s   v1.18.0
[root@master01 ~]#
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h3 id="节点加入集群"><a href="#节点加入集群" class="header-anchor">#</a> 节点加入集群</h3> <h4 id="创建token-token有效时间24h"><a href="#创建token-token有效时间24h" class="header-anchor">#</a> 创建token，token有效时间24h</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@k8s-master~]# kubeadm token create
c9afga.w3fue0yh3gzxczic
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="查看token"><a href="#查看token" class="header-anchor">#</a> 查看token</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@k8s-master~]# kubeadm token list
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="获取ca证书sha256编码hash值"><a href="#获取ca证书sha256编码hash值" class="header-anchor">#</a> 获取ca证书sha256编码hash值</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@k8s-master~]# openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null | openssl dgst -sha256 -hex | sed 's/^.* //'
8b79b6461e58c07333cb2851fe74fd4374af8bbbe0bf7e040b415b86ad4fb89d
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="节点加入集群-2"><a href="#节点加入集群-2" class="header-anchor">#</a> 节点加入集群</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@k8s-node~]# kubeadm reset
[root@k8s-node~]# kubeadm join 192.168.100.7:6443 --token c9afga.w3fue0yh3gzxczic --discovery-token-ca-cert-hash sha256:8b79b6461e58c07333cb2851fe74fd4374af8bbbe0bf7e040b415b86ad4fb89d
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="节点查看"><a href="#节点查看" class="header-anchor">#</a> 节点查看</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master ~]# kubectl get nodes
NAME       STATUS   ROLES                  AGE   VERSION
master     Ready    control-plane,master   14h   v1.20.2
node       Ready    &lt;none&gt;                 10m   v1.20.2
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="master加入集群"><a href="#master加入集群" class="header-anchor">#</a> master加入集群</h3> <h4 id="设置免密登录"><a href="#设置免密登录" class="header-anchor">#</a> 设置免密登录</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master01 ~]# ssh-keygen -t rsa
[root@master01 ~]# ssh-copy-id -i /root/.ssh/id_rsa.pub root@192.168.100.9
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="同步相关证书脚本"><a href="#同步相关证书脚本" class="header-anchor">#</a> 同步相关证书脚本</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@master home]# cat scp.sh 
USER=root
CONTROL_PLANE_IPS=&quot;192.168.100.9&quot;
for host in ${CONTROL_PLANE_IPS}; 
do
    scp /etc/kubernetes/pki/ca.crt &quot;${USER}&quot;@$host:
    scp /etc/kubernetes/pki/ca.key &quot;${USER}&quot;@$host:
    scp /etc/kubernetes/pki/sa.key &quot;${USER}&quot;@$host:
    scp /etc/kubernetes/pki/sa.pub &quot;${USER}&quot;@$host:
    scp /etc/kubernetes/pki/front-proxy-ca.crt &quot;${USER}&quot;@$host:
    scp /etc/kubernetes/pki/front-proxy-ca.key &quot;${USER}&quot;@$host:
    scp /etc/kubernetes/pki/etcd/ca.crt &quot;${USER}&quot;@$host:etcd-ca.crt
    scp /etc/kubernetes/pki/etcd/ca.key &quot;${USER}&quot;@$host:etcd-ca.key
    scp /etc/kubernetes/admin.conf &quot;${USER}&quot;@$host:
    ssh ${USER}@${host} 'mkdir -p /etc/kubernetes/pki/etcd'
    ssh ${USER}@${host} 'mv /${USER}/ca.crt /etc/kubernetes/pki/'
    ssh ${USER}@${host} 'mv /${USER}/ca.key /etc/kubernetes/pki/'
    ssh ${USER}@${host} 'mv /${USER}/sa.pub /etc/kubernetes/pki/'
    ssh ${USER}@${host} 'mv /${USER}/sa.key /etc/kubernetes/pki/'
    ssh ${USER}@${host} 'mv /${USER}/front-proxy-ca.crt /etc/kubernetes/pki/'
    ssh ${USER}@${host} 'mv /${USER}/front-proxy-ca.key /etc/kubernetes/pki/'
    ssh ${USER}@${host} 'mv /${USER}/etcd-ca.crt /etc/kubernetes/pki/etcd/ca.crt'
    ssh ${USER}@${host} 'mv /${USER}/etcd-ca.key /etc/kubernetes/pki/etcd/ca.key'
    ssh ${USER}@${host} 'mv /${USER}/admin.conf /etc/kubernetes/admin.conf'
done
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h4 id="节点加入集群-3"><a href="#节点加入集群-3" class="header-anchor">#</a> 节点加入集群</h4> <div class="language- line-numbers-mode"><pre class="language-text"><code>[root@k8s-node~]# kubeadm reset
[root@k8s-node~]# kubeadm join 192.168.100.7:6443 --token c9afga.w3fue0yh3gzxczic --discovery-token-ca-cert-hash sha256:8b79b6461e58c07333cb2851fe74fd4374af8bbbe0bf7e040b415b86ad4fb89d --control-plane
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="安装helm"><a href="#安装helm" class="header-anchor">#</a> 安装Helm</h2> <h3 id="创建权限"><a href="#创建权限" class="header-anchor">#</a> 创建权限</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>apiVersion: v1
kind: ServiceAccount
metadata:
  name: tiller
  namespace: kube-system
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: tiller
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: ClusterRole
  name: cluster-admin
subjects:
  - kind: ServiceAccount
    name: tiller
    namespace: kube-system
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>[root@k8s-node1 k8s]# kubectl apply -f helm_rbac.yaml
serviceaccount/tiller created
clusterrolebinding.rbac.authorization.k8s.io/tiller created
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="下载安装包并安装"><a href="#下载安装包并安装" class="header-anchor">#</a> 下载安装包并安装</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>#下载安装包 https://github.com/helm/helm/releases
wget https://get.helm.sh/helm-v2.16.3-linux-amd64.tar.gz
#解压压缩包
tar -zxvf helm-v2.16.3.tar.gz
mv helm-v2.16.3/helm /usr/local/bin/helm
mv helm-v2.16.3/tiller /usr/local/bin/tiller
#验证
helm help
初始化
helm init --service-account=tiller --tiller-image=registry.cn-hangzhou.aliyuncs.com/google_containers/tiller:v2.16.3 --history-max 300
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="验证-helm-或-tiller"><a href="#验证-helm-或-tiller" class="header-anchor">#</a> 验证 helm 或 tiller</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code>kubectl -n kube-system get pods|grep tiller
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h3 id="检查-tiller-是否部署到-k8s"><a href="#检查-tiller-是否部署到-k8s" class="header-anchor">#</a> 检查 tiller 是否部署到 k8s</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-node1 local<span class="token punctuation">]</span><span class="token comment"># kubectl get pod -n kube-system -l app=helm</span>
NAME                             READY   STATUS    RESTARTS   AGE
tiller-deploy-7b76b656b5-m4k2x   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          94s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="安装openebs"><a href="#安装openebs" class="header-anchor">#</a> 安装openEBS</h3> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-node1 local<span class="token punctuation">]</span><span class="token comment"># kubectl create ns openebs</span>
namespace/openebs created
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h4 id="安装-2"><a href="#安装-2" class="header-anchor">#</a> 安装</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-node1 local<span class="token punctuation">]</span><span class="token comment"># helm install --namespace openebs --name openebs stable/openebs --version 1.5.0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h4 id="验证等待安装完成"><a href="#验证等待安装完成" class="header-anchor">#</a> 验证等待安装完成</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@master01 manifests<span class="token punctuation">]</span><span class="token comment"># kubectl get pods -n openebs</span>
NAME                                           READY   STATUS    RESTARTS   AGE
openebs-admission-server-5dbc9f4456-vv74r      <span class="token number">1</span>/1     Running   <span class="token number">0</span>          12m
openebs-apiserver-659d656db5-fhdzn             <span class="token number">1</span>/1     Running   <span class="token number">0</span>          12m
openebs-localpv-provisioner-6cb9d78965-82fnj   <span class="token number">1</span>/1     Running   <span class="token number">0</span>          12m
openebs-ndm-2t2tm                              <span class="token number">1</span>/1     Running   <span class="token number">0</span>          12m
openebs-ndm-operator-5ff78c45f6-549tp          <span class="token number">1</span>/1     Running   <span class="token number">0</span>          12m
openebs-provisioner-77b84d8cc-rpvfz            <span class="token number">1</span>/1     Running   <span class="token number">0</span>          12m
openebs-snapshot-operator-6dcc7b6fbd-8nh82     <span class="token number">2</span>/2     Running   <span class="token number">0</span>          12m
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="将-openebs-hostpath设置为默认的-storageclass"><a href="#将-openebs-hostpath设置为默认的-storageclass" class="header-anchor">#</a> 将 openebs-hostpath设置为默认的 StorageClass</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>root@k8s-node1 local<span class="token punctuation">]</span><span class="token comment"># kubectl patch storageclass openebs-hostpath -p '{&quot;metadata&quot;: {&quot;annotations&quot;:{&quot;storageclass.kubernetes.io/is-default-class&quot;:&quot;true&quot;}}}'</span>
storageclass.storage.k8s.io/openebs-hostpath patched
<span class="token punctuation">[</span>root@k8s-node1 local<span class="token punctuation">]</span><span class="token comment"># kubectl get sc</span>
NAME                         PROVISIONER                                                RECLAIMPOLICY   VOLUMEBINDINGMODE      ALLOWVOLUMEEXPANSION   AGE
openebs-device               openebs.io/local                                           Delete          WaitForFirstConsumer   <span class="token boolean">false</span>                  7m20s
openebs-hostpath <span class="token punctuation">(</span>default<span class="token punctuation">)</span>   openebs.io/local                                           Delete          WaitForFirstConsumer   <span class="token boolean">false</span>                  7m20s
openebs-jiva-default         openebs.io/provisioner-iscsi                               Delete          Immediate              <span class="token boolean">false</span>                  7m21s
openebs-snapshot-promoter    volumesnapshot.external-storage.k8s.io/snapshot-promoter   Delete          Immediate              <span class="token boolean">false</span>                  7m20s
openebs-hostpath 变为 default
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div></div></div> <!----> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">更新时间:</span> <span class="time">2024/01/17, 05:48:13</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/e5a304/"><div>
            JVM调优
            <!----></div></a> <span class="date">12-10</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/578cf2/"><div>
            jenkins
            <!----></div></a> <span class="date">12-10</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/b6e7a0/"><div>
            Arthas
            <!----></div></a> <span class="date">12-10</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/micolor" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://gitee.com/micolor" title="Gitee" target="_blank" class="iconfont icon-gitee"></a><a href="https://www.niubook.xom" title="网站首页" target="_blank" class="iconfont icon-rss"></a><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=349462253&amp;site=qq&amp;menu=yes" title="QQ" target="_blank" class="iconfont icon-QQ"></a><a href="https://www.niubook.com/?contact=true" title="联系我" target="_blank" class="iconfont icon-youjian"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2024
    <span>KNOTE  | blog</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div><!----><canvas id="vuepress-canvas-cursor"></canvas></div></div>
    <script src="/assets/js/app.be13efeb.js" defer></script><script src="/assets/js/2.6721fee8.js" defer></script><script src="/assets/js/503.5a73da6a.js" defer></script><script src="/assets/js/4.7df05356.js" defer></script>
  </body>
</html>
